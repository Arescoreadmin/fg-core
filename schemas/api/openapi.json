{
  "components": {
    "schemas": {
      "ApprovalCreateRequest": {
        "properties": {
          "action": {
            "maxLength": 64,
            "minLength": 1,
            "title": "Action",
            "type": "string"
          },
          "approver": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Approver",
            "type": "string"
          },
          "bundle_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bundle Id"
          },
          "reason": {
            "maxLength": 1024,
            "minLength": 1,
            "title": "Reason",
            "type": "string"
          },
          "subject_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Subject Id",
            "type": "string"
          },
          "subject_type": {
            "maxLength": 64,
            "minLength": 1,
            "title": "Subject Type",
            "type": "string"
          },
          "tenant_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Tenant Id",
            "type": "string"
          }
        },
        "required": [
          "tenant_id",
          "subject_type",
          "subject_id",
          "action",
          "approver",
          "reason"
        ],
        "title": "ApprovalCreateRequest",
        "type": "object"
      },
      "ApprovalVerifyRequest": {
        "properties": {
          "subject_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Subject Id",
            "type": "string"
          },
          "subject_type": {
            "maxLength": 64,
            "minLength": 1,
            "title": "Subject Type",
            "type": "string"
          },
          "tenant_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Tenant Id",
            "type": "string"
          }
        },
        "required": [
          "tenant_id",
          "subject_type",
          "subject_id"
        ],
        "title": "ApprovalVerifyRequest",
        "type": "object"
      },
      "ArtifactMeta": {
        "properties": {
          "name": {
            "title": "Name",
            "type": "string"
          },
          "sha256": {
            "maxLength": 64,
            "minLength": 64,
            "title": "Sha256",
            "type": "string"
          },
          "uri": {
            "title": "Uri",
            "type": "string"
          }
        },
        "required": [
          "name",
          "uri",
          "sha256"
        ],
        "title": "ArtifactMeta",
        "type": "object"
      },
      "CancelJobRequest": {
        "properties": {
          "notes": {
            "default": "",
            "maxLength": 512,
            "title": "Notes",
            "type": "string"
          },
          "reason": {
            "default": "OPERATOR_ERROR",
            "maxLength": 64,
            "title": "Reason",
            "type": "string"
          },
          "ticket_id": {
            "default": "",
            "maxLength": 128,
            "title": "Ticket Id",
            "type": "string"
          }
        },
        "title": "CancelJobRequest",
        "type": "object"
      },
      "ClassificationRing": {
        "enum": [
          "UNCLASS",
          "CUI",
          "SECRET",
          "TOPSECRET"
        ],
        "title": "ClassificationRing",
        "type": "string"
      },
      "ConfigWriteRequest": {
        "properties": {
          "config_payload": {
            "title": "Config Payload",
            "type": "object"
          },
          "created_by": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created By"
          },
          "parent_hash": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Parent Hash"
          },
          "set_active": {
            "default": true,
            "title": "Set Active",
            "type": "boolean"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          }
        },
        "title": "ConfigWriteRequest",
        "type": "object"
      },
      "CoverageChangeRequest": {
        "properties": {
          "action": {
            "enum": [
              "ADD",
              "REMOVE",
              "CHANGE",
              "RETIRE",
              "MERGE"
            ],
            "title": "Action",
            "type": "string"
          },
          "config_hash": {
            "title": "Config Hash",
            "type": "string"
          },
          "device_id": {
            "title": "Device Id",
            "type": "string"
          },
          "effective_from": {
            "format": "date-time",
            "title": "Effective From",
            "type": "string"
          },
          "effective_to": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Effective To"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "plan_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Plan Id"
          },
          "policy_hash": {
            "title": "Policy Hash",
            "type": "string"
          },
          "pricing_version_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Pricing Version Id"
          },
          "source": {
            "default": "api",
            "title": "Source",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          }
        },
        "required": [
          "event_id",
          "device_id",
          "action",
          "effective_from",
          "config_hash",
          "policy_hash"
        ],
        "title": "CoverageChangeRequest",
        "type": "object"
      },
      "CreateKeyRequest": {
        "description": "Request to create a new API key.",
        "properties": {
          "name": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Human-readable name for the key",
            "title": "Name"
          },
          "scopes": {
            "description": "List of scopes to grant to the key",
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Tenant ID to associate with the key",
            "title": "Tenant Id"
          },
          "ttl_seconds": {
            "default": 86400,
            "description": "Time-to-live in seconds (default 24 hours)",
            "maximum": 31536000.0,
            "minimum": 60.0,
            "title": "Ttl Seconds",
            "type": "integer"
          }
        },
        "title": "CreateKeyRequest",
        "type": "object"
      },
      "CreateKeyResponse": {
        "description": "Response containing the newly created API key.",
        "properties": {
          "expires_at": {
            "description": "Unix timestamp when key expires",
            "title": "Expires At",
            "type": "integer"
          },
          "key": {
            "description": "The full API key (only shown once)",
            "title": "Key",
            "type": "string"
          },
          "prefix": {
            "description": "Key prefix for identification",
            "title": "Prefix",
            "type": "string"
          },
          "scopes": {
            "description": "Scopes granted to the key",
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Associated tenant ID",
            "title": "Tenant Id"
          },
          "ttl_seconds": {
            "description": "Time-to-live in seconds",
            "title": "Ttl Seconds",
            "type": "integer"
          }
        },
        "required": [
          "key",
          "prefix",
          "scopes",
          "tenant_id",
          "ttl_seconds",
          "expires_at"
        ],
        "title": "CreateKeyResponse",
        "type": "object"
      },
      "CreditNoteCreateRequest": {
        "properties": {
          "amount": {
            "title": "Amount",
            "type": "number"
          },
          "created_by": {
            "title": "Created By",
            "type": "string"
          },
          "credit_note_id": {
            "title": "Credit Note Id",
            "type": "string"
          },
          "currency": {
            "default": "USD",
            "title": "Currency",
            "type": "string"
          },
          "reason": {
            "title": "Reason",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "ticket_id": {
            "title": "Ticket Id",
            "type": "string"
          }
        },
        "required": [
          "credit_note_id",
          "amount",
          "reason",
          "ticket_id",
          "created_by"
        ],
        "title": "CreditNoteCreateRequest",
        "type": "object"
      },
      "DecisionExplain": {
        "properties": {
          "anomaly_score": {
            "default": 0.0,
            "title": "Anomaly Score",
            "type": "number"
          },
          "ao_required": {
            "default": false,
            "title": "Ao Required",
            "type": "boolean"
          },
          "classification": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Classification"
          },
          "disruption_limited": {
            "default": false,
            "title": "Disruption Limited",
            "type": "boolean"
          },
          "llm_note": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Llm Note"
          },
          "persona": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          },
          "roe_applied": {
            "default": false,
            "title": "Roe Applied",
            "type": "boolean"
          },
          "rules_triggered": {
            "items": {
              "type": "string"
            },
            "title": "Rules Triggered",
            "type": "array"
          },
          "score": {
            "default": 0,
            "title": "Score",
            "type": "integer"
          },
          "summary": {
            "title": "Summary",
            "type": "string"
          },
          "tie_d": {
            "$ref": "#/components/schemas/TieD"
          }
        },
        "required": [
          "summary"
        ],
        "title": "DecisionExplain",
        "type": "object"
      },
      "DecisionOut": {
        "properties": {
          "ai_adversarial_score": {
            "title": "Ai Adversarial Score",
            "type": "number"
          },
          "anomaly_score": {
            "title": "Anomaly Score",
            "type": "number"
          },
          "config_hash": {
            "title": "Config Hash",
            "type": "string"
          },
          "created_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At"
          },
          "decision_diff": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Decision Diff"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "event_type": {
            "title": "Event Type",
            "type": "string"
          },
          "explain_summary": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Explain Summary"
          },
          "id": {
            "title": "Id",
            "type": "integer"
          },
          "latency_ms": {
            "default": 0,
            "title": "Latency Ms",
            "type": "integer"
          },
          "pq_fallback": {
            "title": "Pq Fallback",
            "type": "boolean"
          },
          "request": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Request"
          },
          "response": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Response"
          },
          "rules_triggered": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Rules Triggered"
          },
          "source": {
            "title": "Source",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "threat_level": {
            "title": "Threat Level",
            "type": "string"
          }
        },
        "required": [
          "id",
          "tenant_id",
          "source",
          "event_id",
          "event_type",
          "threat_level",
          "anomaly_score",
          "ai_adversarial_score",
          "pq_fallback",
          "config_hash"
        ],
        "title": "DecisionOut",
        "type": "object"
      },
      "DecisionsPage": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/DecisionOut"
            },
            "title": "Items",
            "type": "array"
          },
          "limit": {
            "title": "Limit",
            "type": "integer"
          },
          "offset": {
            "title": "Offset",
            "type": "integer"
          },
          "total": {
            "title": "Total",
            "type": "integer"
          }
        },
        "required": [
          "limit",
          "offset",
          "total"
        ],
        "title": "DecisionsPage",
        "type": "object"
      },
      "DefendResponse": {
        "properties": {
          "ai_adversarial_score": {
            "default": 0.0,
            "title": "Ai Adversarial Score",
            "type": "number"
          },
          "clock_drift_ms": {
            "title": "Clock Drift Ms",
            "type": "integer"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "explain": {
            "$ref": "#/components/schemas/DecisionExplain"
          },
          "explanation_brief": {
            "title": "Explanation Brief",
            "type": "string"
          },
          "mitigations": {
            "items": {
              "$ref": "#/components/schemas/MitigationAction"
            },
            "title": "Mitigations",
            "type": "array"
          },
          "policy": {
            "$ref": "#/components/schemas/PolicyDecision"
          },
          "policy_hash": {
            "title": "Policy Hash",
            "type": "string"
          },
          "pq_fallback": {
            "default": false,
            "title": "Pq Fallback",
            "type": "boolean"
          },
          "threat_level": {
            "enum": [
              "none",
              "low",
              "medium",
              "high",
              "critical"
            ],
            "title": "Threat Level",
            "type": "string"
          }
        },
        "required": [
          "explanation_brief",
          "threat_level",
          "explain",
          "clock_drift_ms",
          "event_id",
          "policy_hash",
          "policy"
        ],
        "title": "DefendResponse",
        "type": "object"
      },
      "DeviceActivityProofRequest": {
        "properties": {
          "activity_day": {
            "format": "date",
            "title": "Activity Day",
            "type": "string"
          },
          "device_id": {
            "title": "Device Id",
            "type": "string"
          },
          "proof_hash": {
            "title": "Proof Hash",
            "type": "string"
          },
          "proof_type": {
            "title": "Proof Type",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          }
        },
        "required": [
          "device_id",
          "activity_day",
          "proof_type",
          "proof_hash"
        ],
        "title": "DeviceActivityProofRequest",
        "type": "object"
      },
      "DeviceEnrollRequest": {
        "properties": {
          "attestation_payload_hash": {
            "title": "Attestation Payload Hash",
            "type": "string"
          },
          "attestation_type": {
            "title": "Attestation Type",
            "type": "string"
          },
          "device_id": {
            "title": "Device Id",
            "type": "string"
          },
          "enrolled_by": {
            "title": "Enrolled By",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          }
        },
        "required": [
          "device_id",
          "attestation_type",
          "attestation_payload_hash",
          "enrolled_by"
        ],
        "title": "DeviceEnrollRequest",
        "type": "object"
      },
      "ExportJobRequest": {
        "properties": {
          "end": {
            "title": "End",
            "type": "string"
          },
          "end_inclusive": {
            "default": true,
            "title": "End Inclusive",
            "type": "boolean"
          },
          "force": {
            "default": false,
            "title": "Force",
            "type": "boolean"
          },
          "purpose": {
            "default": "compliance-review",
            "title": "Purpose",
            "type": "string"
          },
          "retention_class": {
            "default": "regulated",
            "title": "Retention Class",
            "type": "string"
          },
          "signing_kid": {
            "default": "",
            "title": "Signing Kid",
            "type": "string"
          },
          "start": {
            "title": "Start",
            "type": "string"
          }
        },
        "required": [
          "start",
          "end"
        ],
        "title": "ExportJobRequest",
        "type": "object"
      },
      "FeedItem": {
        "properties": {
          "agent_stable_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Agent Stable Id"
          },
          "asset_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Asset Id"
          },
          "asset_verified": {
            "default": false,
            "title": "Asset Verified",
            "type": "boolean"
          },
          "attestation_level": {
            "default": "none",
            "title": "Attestation Level",
            "type": "string"
          },
          "device_type": {
            "default": "unknown",
            "title": "Device Type",
            "type": "string"
          },
          "fingerprint_hash": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Fingerprint Hash"
          },
          "labels": {
            "title": "Labels",
            "type": "object"
          },
          "source_agent_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Source Agent Id"
          },
          "source_ip": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Source Ip"
          },
          "status": {
            "default": "active",
            "title": "Status",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          }
        },
        "title": "DeviceUpsertRequest",
        "type": "object"
      },
      "DisputeResolveRequest": {
        "properties": {
          "reason": {
            "title": "Reason",
            "type": "string"
          },
          "resolution_type": {
            "enum": [
              "manual_review",
              "asset_registry_proof",
              "agent_attestation"
            ],
            "title": "Resolution Type",
            "type": "string"
          },
          "resolved_by": {
            "title": "Resolved By",
            "type": "string"
          },
          "resolved_device_id": {
            "title": "Resolved Device Id",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "ticket_id": {
            "title": "Ticket Id",
            "type": "string"
          }
        },
        "required": [
          "resolved_device_id",
          "reason",
          "ticket_id",
          "resolution_type",
          "resolved_by"
        ],
        "title": "DisputeResolveRequest",
        "type": "object"
      },
      "EvidenceBundleCreateRequest": {
        "properties": {
          "artifacts": {
            "items": {
              "$ref": "#/components/schemas/ArtifactMeta"
            },
            "title": "Artifacts",
            "type": "array"
          },
          "payload": {
            "title": "Payload",
            "type": "object"
          },
          "subject_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Subject Id",
            "type": "string"
          },
          "subject_type": {
            "maxLength": 64,
            "minLength": 1,
            "title": "Subject Type",
            "type": "string"
          },
          "tenant_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Tenant Id",
            "type": "string"
          }
        },
        "required": [
          "tenant_id",
          "subject_type",
          "subject_id",
          "payload"
        ],
        "title": "EvidenceBundleCreateRequest",
        "type": "object"
      },
      "EvidenceBundleCreateResponse": {
        "properties": {
          "bundle_hash": {
            "title": "Bundle Hash",
            "type": "string"
          },
          "bundle_id": {
            "title": "Bundle Id",
            "type": "string"
          },
          "created_at": {
            "format": "date-time",
            "title": "Created At",
            "type": "string"
          },
          "key_id": {
            "title": "Key Id",
            "type": "string"
          },
          "signature": {
            "title": "Signature",
            "type": "string"
          }
        },
        "required": [
          "bundle_id",
          "bundle_hash",
          "signature",
          "key_id",
          "created_at"
        ],
        "title": "EvidenceBundleCreateResponse",
        "type": "object"
      },
      "EvidenceVerifyRequest": {
        "properties": {
          "bundle": {
            "title": "Bundle",
            "type": "object"
          },
          "bundle_hash": {
            "maxLength": 64,
            "minLength": 64,
            "title": "Bundle Hash",
            "type": "string"
          },
          "key_id": {
            "title": "Key Id",
            "type": "string"
          },
          "signature": {
            "title": "Signature",
            "type": "string"
          }
        },
        "required": [
          "bundle",
          "bundle_hash",
          "signature",
          "key_id"
        ],
        "title": "EvidenceVerifyRequest",
        "type": "object"
      },
      "EvidenceVerifyResponse": {
        "properties": {
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reason"
          },
          "verified": {
            "title": "Verified",
            "type": "boolean"
          }
        },
        "required": [
          "verified"
        ],
        "title": "EvidenceVerifyResponse",
        "type": "object"
      },
      "FeedItem": {
        "properties": {
          "action_reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Action Reason"
          },
          "action_taken": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Action Taken"
          },
          "changed_fields": {
            "items": {
              "type": "string"
            },
            "title": "Changed Fields",
            "type": "array"
          },
          "confidence": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Confidence"
          },
          "decision_diff": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Decision Diff"
          },
          "decision_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Decision Id"
          },
          "event_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Event Id"
          },
          "event_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Event Type"
          },
          "fingerprint": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Fingerprint"
          },
          "id": {
            "title": "Id",
            "type": "integer"
          },
          "metadata": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Metadata"
          },
          "rules_triggered": {
            "items": {
              "type": "string"
            },
            "title": "Rules Triggered",
            "type": "array"
          },
          "score": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Score"
          },
          "severity": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Severity"
          },
          "source": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Source"
          },
          "summary": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Summary"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "threat_level": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Threat Level"
          },
          "timestamp": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timestamp"
          },
          "title": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Title"
          }
        },
        "required": [
          "id"
        ],
        "title": "FeedItem",
        "type": "object"
      },
      "FeedLiveResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/FeedItem"
            },
            "title": "Items",
            "type": "array"
          },
          "next_since_id": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Next Since Id"
          }
        },
        "title": "FeedLiveResponse",
        "type": "object"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "title": "Detail",
            "type": "array"
          }
        },
        "title": "HTTPValidationError",
        "type": "object"
      },
      "Health": {
        "$ref": "schemas/api/health.schema.json"
      },
      "IngestRequest": {
        "additionalProperties": true,
        "properties": {
          "classification": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Classification"
          },
          "event": {
            "title": "Event",
            "type": "object"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "event_type": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Event Type"
          },
          "payload": {
            "title": "Payload",
            "type": "object"
          },
          "persona": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          },
          "source": {
            "maxLength": 256,
            "title": "Source",
            "type": "string"
          },
          "src_ip": {
            "anyOf": [
              {
                "maxLength": 45,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Src Ip"
          },
          "tenant_id": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "timestamp": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timestamp"
          }
        },
        "required": [
          "source",
          "event_id"
        ],
        "title": "IngestRequest",
        "type": "object"
      },
      "IngestResponse": {
        "properties": {
          "config_hash": {
            "title": "Config Hash",
            "type": "string"
          },
          "decision": {
            "title": "Decision",
            "type": "object"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "event_type": {
            "title": "Event Type",
            "type": "string"
          },
          "latency_ms": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Latency Ms"
          },
          "persisted": {
            "default": true,
            "title": "Persisted",
            "type": "boolean"
          },
          "source": {
            "title": "Source",
            "type": "string"
          },
          "status": {
            "default": "ok",
            "title": "Status",
            "type": "string"
          },
          "tenant_id": {
            "title": "Tenant Id",
            "type": "string"
          },
          "threat_level": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Threat Level"
          }
        },
        "required": [
          "event_id",
          "tenant_id",
          "source",
          "event_type",
          "config_hash"
        ],
        "title": "IngestResponse",
        "type": "object"
      },
      "InvoiceCreateRequest": {
        "properties": {
          "config_hash": {
            "title": "Config Hash",
            "type": "string"
          },
          "invoice_id": {
            "title": "Invoice Id",
            "type": "string"
          },
          "period_end": {
            "format": "date-time",
            "title": "Period End",
            "type": "string"
          },
          "period_start": {
            "format": "date-time",
            "title": "Period Start",
            "type": "string"
          },
          "policy_hash": {
            "title": "Policy Hash",
            "type": "string"
          },
          "pricing_version_id": {
            "title": "Pricing Version Id",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          }
        },
        "required": [
          "invoice_id",
          "period_start",
          "period_end",
          "pricing_version_id",
          "config_hash",
          "policy_hash"
        ],
        "title": "InvoiceCreateRequest",
        "type": "object"
      },
      "InvoiceFinalizeRequest": {
        "properties": {
          "finalized_by": {
            "title": "Finalized By",
            "type": "string"
          },
          "reason": {
            "title": "Reason",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "ticket_id": {
            "title": "Ticket Id",
            "type": "string"
          }
        },
        "required": [
          "finalized_by",
          "ticket_id",
          "reason"
        ],
        "title": "InvoiceFinalizeRequest",
        "type": "object"
      },
      "InvoiceReproduceResponse": {
        "properties": {
          "invoice_id": {
            "title": "Invoice Id",
            "type": "string"
          },
          "match": {
            "title": "Match",
            "type": "boolean"
          },
          "recomputed_hash": {
            "title": "Recomputed Hash",
            "type": "string"
          },
          "stored_hash": {
            "title": "Stored Hash",
            "type": "string"
          }
        },
        "required": [
          "invoice_id",
          "recomputed_hash",
          "stored_hash",
          "match"
        ],
        "title": "InvoiceReproduceResponse",
        "type": "object"
      },
      "KeyInfo": {
        "description": "Information about an API key (without the secret).",
        "properties": {
          "created_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At"
          },
          "enabled": {
            "default": true,
            "title": "Enabled",
            "type": "boolean"
          },
          "expires_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expires At"
          },
          "last_used_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Used At"
          },
          "name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Name"
          },
          "prefix": {
            "title": "Prefix",
            "type": "string"
          },
          "scopes": {
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "use_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Use Count"
          }
        },
        "required": [
          "prefix"
        ],
        "title": "KeyInfo",
        "type": "object"
      },
      "ListKeysResponse": {
        "description": "Response containing list of API keys.",
        "properties": {
          "keys": {
            "items": {
              "$ref": "#/components/schemas/KeyInfo"
            },
            "title": "Keys",
            "type": "array"
          },
          "total": {
            "title": "Total",
            "type": "integer"
          }
        },
        "required": [
          "keys",
          "total"
        ],
        "title": "ListKeysResponse",
        "type": "object"
      },
      "MissionEnvelope": {
        "properties": {
          "allowed_mitigations": {
            "items": {
              "type": "string"
            },
            "title": "Allowed Mitigations",
            "type": "array"
          },
          "blast_radius_cap": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Blast Radius Cap"
          },
          "budget_cap": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Budget Cap"
          },
          "classification_level": {
            "title": "Classification Level",
            "type": "string"
          },
          "forensic_threshold": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Forensic Threshold"
          },
          "mission_id": {
            "title": "Mission Id",
            "type": "string"
          },
          "model_version": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Model Version"
          },
          "persona": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          },
          "risk_tier": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Risk Tier"
          },
          "scope_hash": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Scope Hash"
          },
          "signature": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Signature"
          },
          "valid_from": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Valid From"
          },
          "valid_to": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Valid To"
          }
        },
        "required": [
          "mission_id",
          "classification_level"
        ],
        "title": "MissionEnvelope",
        "type": "object"
      },
      "MitigationAction": {
        "properties": {
          "action": {
            "title": "Action",
            "type": "string"
          },
          "confidence": {
            "default": 1.0,
            "title": "Confidence",
            "type": "number"
          },
          "meta": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Meta"
          },
          "reason": {
            "title": "Reason",
            "type": "string"
          },
          "target": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Target"
          }
        },
        "required": [
          "action",
          "reason"
        ],
        "title": "MitigationAction",
        "type": "object"
      },
      "ModuleRegistrationRequest": {
        "properties": {
          "build_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Build Id",
            "type": "string"
          },
          "capabilities": {
            "items": {
              "type": "string"
            },
            "minItems": 1,
            "title": "Capabilities",
            "type": "array"
          },
          "evidence_bundle_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Evidence Bundle Id"
          },
          "git_sha": {
            "maxLength": 64,
            "minLength": 7,
            "title": "Git Sha",
            "type": "string"
          },
          "module_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Module Id",
            "type": "string"
          },
          "required_scopes": {
            "items": {
              "type": "string"
            },
            "title": "Required Scopes",
            "type": "array"
          },
          "sbom_ref": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Sbom Ref"
          },
          "tenant_id": {
            "maxLength": 128,
            "minLength": 1,
            "title": "Tenant Id",
            "type": "string"
          },
          "version": {
            "maxLength": 64,
            "minLength": 1,
            "title": "Version",
            "type": "string"
          }
        },
        "required": [
          "tenant_id",
          "module_id",
          "version",
          "capabilities",
          "git_sha",
          "build_id"
        ],
        "title": "ModuleRegistrationRequest",
        "type": "object"
      },
      "PolicyApprovalRequest": {
        "description": "Request model for approving a policy change.",
        "properties": {
          "approver": {
            "title": "Approver",
            "type": "string"
          },
          "notes": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Notes"
          }
        },
        "required": [
          "approver"
        ],
        "title": "PolicyApprovalRequest",
        "type": "object"
      },
      "PolicyChangeCreate": {
        "description": "Request model for creating a policy change.",
        "properties": {
          "change_type": {
            "title": "Change Type",
            "type": "string"
          },
          "justification": {
            "title": "Justification",
            "type": "string"
          },
          "proposed_by": {
            "title": "Proposed By",
            "type": "string"
          },
          "roe_update": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Roe Update"
          },
          "rule_definition": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rule Definition"
          }
        },
        "required": [
          "change_type",
          "proposed_by",
          "justification"
        ],
        "title": "PolicyChangeCreate",
        "type": "object"
      },
      "PolicyChangeResponse": {
        "description": "Response model for policy change requests.",
        "properties": {
          "approvals": {
            "items": {
              "type": "object"
            },
            "title": "Approvals",
            "type": "array"
          },
          "change_id": {
            "title": "Change Id",
            "type": "string"
          },
          "change_type": {
            "title": "Change Type",
            "type": "string"
          },
          "confidence": {
            "default": "medium",
            "title": "Confidence",
            "type": "string"
          },
          "deployed_at": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Deployed At"
          },
          "estimated_false_positives": {
            "default": 0,
            "title": "Estimated False Positives",
            "type": "integer"
          },
          "estimated_true_positives": {
            "default": 0,
            "title": "Estimated True Positives",
            "type": "integer"
          },
          "justification": {
            "title": "Justification",
            "type": "string"
          },
          "proposed_at": {
            "format": "date-time",
            "title": "Proposed At",
            "type": "string"
          },
          "proposed_by": {
            "title": "Proposed By",
            "type": "string"
          },
          "requires_approval_from": {
            "items": {
              "type": "string"
            },
            "title": "Requires Approval From",
            "type": "array"
          },
          "roe_update": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Roe Update"
          },
          "rule_definition": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rule Definition"
          },
          "simulation_results": {
            "title": "Simulation Results",
            "type": "object"
          },
          "status": {
            "default": "pending",
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "change_id",
          "change_type",
          "proposed_by",
          "proposed_at",
          "justification"
        ],
        "title": "PolicyChangeResponse",
        "type": "object"
      },
      "PolicyDecision": {
        "properties": {
          "allow": {
            "title": "Allow",
            "type": "boolean"
          },
          "reasons": {
            "items": {
              "type": "string"
            },
            "title": "Reasons",
            "type": "array"
          }
        },
        "required": [
          "allow"
        ],
        "title": "PolicyDecision",
        "type": "object"
      },
      "ROEEvaluationRequest": {
        "properties": {
          "classification": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Classification"
          },
          "mitigations": {
            "items": {
              "type": "object"
            },
            "title": "Mitigations",
            "type": "array"
          },
          "persona": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          }
        },
        "title": "ROEEvaluationRequest",
        "type": "object"
      },
      "ROEEvaluationResponse": {
        "properties": {
          "gating_decision": {
            "title": "Gating Decision",
            "type": "string"
          },
          "policy": {
            "$ref": "#/components/schemas/ROEPolicy"
          },
          "reason": {
            "title": "Reason",
            "type": "string"
          }
        },
        "required": [
          "gating_decision",
          "reason",
          "policy"
        ],
        "title": "ROEEvaluationResponse",
        "type": "object"
      },
      "ROEPolicy": {
        "properties": {
          "ao_required_actions": {
            "items": {
              "type": "string"
            },
            "title": "Ao Required Actions",
            "type": "array"
          },
          "max_disruption": {
            "default": 1,
            "title": "Max Disruption",
            "type": "integer"
          },
          "policy_id": {
            "default": "roe-default",
            "title": "Policy Id",
            "type": "string"
          }
        },
        "title": "ROEPolicy",
        "type": "object"
      },
      "ReproduceRequest": {
        "properties": {
          "audit_session_id": {
            "title": "Audit Session Id",
            "type": "integer"
          }
        },
        "required": [
          "audit_session_id"
        ],
        "title": "ReproduceRequest",
        "type": "object"
      },
      "RetentionRequest": {
        "properties": {
          "allow_delete_exports": {
            "default": false,
            "title": "Allow Delete Exports",
            "type": "boolean"
          },
          "confirmation_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Confirmation Token"
          },
          "dry_run": {
            "default": true,
            "title": "Dry Run",
            "type": "boolean"
          },
          "reason_code": {
            "title": "Reason Code",
            "type": "string"
          },
          "retention_days": {
            "default": 365,
            "title": "Retention Days",
            "type": "integer"
          },
          "ticket_id": {
            "title": "Ticket Id",
            "type": "string"
          }
        },
        "required": [
          "reason_code",
          "ticket_id"
        ],
        "title": "RetentionRequest",
        "type": "object"
      },
      "RevokeKeyRequest": {
        "description": "Request to revoke an API key.",
        "properties": {
          "prefix": {
            "description": "Key prefix to revoke",
            "maxLength": 64,
            "minLength": 1,
            "title": "Prefix",
            "type": "string"
          }
        },
        "required": [
          "prefix"
        ],
        "title": "RevokeKeyRequest",
        "type": "object"
      },
      "RevokeKeyResponse": {
        "description": "Response after revoking an API key.",
        "properties": {
          "message": {
            "title": "Message",
            "type": "string"
          },
          "prefix": {
            "title": "Prefix",
            "type": "string"
          },
          "revoked": {
            "title": "Revoked",
            "type": "boolean"
          }
        },
        "required": [
          "revoked",
          "prefix",
          "message"
        ],
        "title": "RevokeKeyResponse",
        "type": "object"
      },
      "RingPolicy": {
        "properties": {
          "audit_level": {
            "default": "basic",
            "pattern": "^(basic|detailed|comprehensive)$",
            "title": "Audit Level",
            "type": "string"
          },
          "cross_ring_queries_allowed": {
            "default": false,
            "title": "Cross Ring Queries Allowed",
            "type": "boolean"
          },
          "encryption_required": {
            "default": true,
            "title": "Encryption Required",
            "type": "boolean"
          },
          "max_retention_days": {
            "default": 30,
            "title": "Max Retention Days",
            "type": "integer"
          },
          "model_isolation": {
            "default": true,
            "title": "Model Isolation",
            "type": "boolean"
          },
          "ring": {
            "$ref": "#/components/schemas/ClassificationRing"
          }
        },
        "required": [
          "ring"
        ],
        "title": "RingPolicy",
        "type": "object"
      },
      "RingRouteRequest": {
        "properties": {
          "classification": {
            "$ref": "#/components/schemas/ClassificationRing"
          }
        },
        "required": [
          "classification"
        ],
        "title": "RingRouteRequest",
        "type": "object"
      },
      "RingRouteResponse": {
        "properties": {
          "db_path": {
            "title": "Db Path",
            "type": "string"
          },
          "model_path": {
            "title": "Model Path",
            "type": "string"
          },
          "policy": {
            "$ref": "#/components/schemas/RingPolicy"
          }
        },
        "required": [
          "db_path",
          "model_path",
          "policy"
        ],
        "title": "RingRouteResponse",
        "type": "object"
      },
      "RotateKeyRequest": {
        "description": "Request to rotate an API key.",
        "properties": {
          "current_key": {
            "description": "The current API key to rotate",
            "maxLength": 256,
            "minLength": 10,
            "title": "Current Key",
            "type": "string"
          },
          "revoke_old": {
            "default": true,
            "description": "Whether to immediately revoke the old key",
            "title": "Revoke Old",
            "type": "boolean"
          },
          "ttl_seconds": {
            "default": 86400,
            "description": "TTL for the new key (default 24 hours)",
            "maximum": 31536000.0,
            "minimum": 60.0,
            "title": "Ttl Seconds",
            "type": "integer"
          }
        },
        "required": [
          "current_key"
        ],
        "title": "RotateKeyRequest",
        "type": "object"
      },
      "RotateKeyResponse": {
        "description": "Response containing the rotated API key.",
        "properties": {
          "expires_at": {
            "description": "Unix timestamp when new key expires",
            "title": "Expires At",
            "type": "integer"
          },
          "new_key": {
            "description": "The new API key (only shown once)",
            "title": "New Key",
            "type": "string"
          },
          "new_prefix": {
            "description": "New key prefix for identification",
            "title": "New Prefix",
            "type": "string"
          },
          "old_key_revoked": {
            "description": "Whether the old key was revoked",
            "title": "Old Key Revoked",
            "type": "boolean"
          },
          "old_prefix": {
            "description": "Old key prefix (for reference)",
            "title": "Old Prefix",
            "type": "string"
          },
          "scopes": {
            "description": "Scopes inherited from old key",
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Associated tenant ID",
            "title": "Tenant Id"
          }
        },
        "required": [
          "new_key",
          "new_prefix",
          "old_prefix",
          "scopes",
          "tenant_id",
          "expires_at",
          "old_key_revoked"
        ],
        "title": "RotateKeyResponse",
        "type": "object"
      },
      "StatsResponse": {
        "properties": {
          "avg_latency_ms_24h": {
            "default": 0.0,
            "title": "Avg Latency Ms 24H",
            "type": "number"
          },
          "decisions_1h": {
            "title": "Decisions 1H",
            "type": "integer"
          },
          "decisions_24h": {
            "title": "Decisions 24H",
            "type": "integer"
          },
          "decisions_7d": {
            "title": "Decisions 7D",
            "type": "integer"
          },
          "generated_at": {
            "title": "Generated At",
            "type": "string"
          },
          "high_threat_rate_1h": {
            "default": 0.0,
            "title": "High Threat Rate 1H",
            "type": "number"
          },
          "pct_high_medium_24h": {
            "default": 0.0,
            "title": "Pct High Medium 24H",
            "type": "number"
          },
          "threat_counts_24h": {
            "$ref": "#/components/schemas/ThreatCounts"
          },
          "top_event_types_24h": {
            "items": {
              "$ref": "#/components/schemas/TopItem"
            },
            "title": "Top Event Types 24H",
            "type": "array"
          },
          "top_rules_24h": {
            "items": {
              "$ref": "#/components/schemas/TopItem"
            },
            "title": "Top Rules 24H",
            "type": "array"
          },
          "top_sources_24h": {
            "items": {
              "$ref": "#/components/schemas/TopItem"
            },
            "title": "Top Sources 24H",
            "type": "array"
          },
          "unique_source_ips_24h": {
            "default": 0,
            "title": "Unique Source Ips 24H",
            "type": "integer"
          }
        },
        "required": [
          "generated_at",
          "decisions_1h",
          "decisions_24h",
          "decisions_7d",
          "threat_counts_24h"
        ],
        "title": "StatsResponse",
        "type": "object"
      },
      "StatsSummaryResponse": {
        "properties": {
          "generated_at": {
            "title": "Generated At",
            "type": "string"
          },
          "headline": {
            "title": "Headline",
            "type": "string"
          },
          "high_threat_rate": {
            "default": 0.0,
            "title": "High Threat Rate",
            "type": "number"
          },
          "most_active_rule": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Most Active Rule"
          },
          "risk_score_1h": {
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Risk Score 1H",
            "type": "integer"
          },
          "risk_score_24h": {
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Risk Score 24H",
            "type": "integer"
          },
          "top_event_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Top Event Type"
          },
          "trend_flag": {
            "pattern": "^(spike|steady|drop)$",
            "title": "Trend Flag",
            "type": "string"
          },
          "unique_ips": {
            "default": 0,
            "title": "Unique Ips",
            "type": "integer"
          }
        },
        "required": [
          "generated_at",
          "risk_score_24h",
          "risk_score_1h",
          "trend_flag",
          "headline"
        ],
        "title": "StatsSummaryResponse",
        "type": "object"
      },
      "TelemetryInput": {
        "additionalProperties": true,
        "description": "Canonical request model for defend/ingest.\n\nCompatibility:\n  - New shape: payload={...} (tests use this)\n  - Legacy shape: event={...} (defend.py references req.event)\n  - Root fields: event_type/src_ip (defend.py references req.event_type)\n  - Doctrine: classification/persona as plain strings\n  - extra=allow for forward compatibility during MVP\n\nSecurity:\n  - Input validation for tenant_id, source, and IP addresses\n  - Length limits to prevent DoS",
        "properties": {
          "classification": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Classification"
          },
          "event": {
            "title": "Event",
            "type": "object"
          },
          "event_type": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Event Type"
          },
          "payload": {
            "title": "Payload",
            "type": "object"
          },
          "persona": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          },
          "source": {
            "maxLength": 256,
            "title": "Source",
            "type": "string"
          },
          "src_ip": {
            "anyOf": [
              {
                "maxLength": 45,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Src Ip"
          },
          "tenant_id": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "timestamp": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timestamp"
          }
        },
        "required": [
          "source"
        ],
        "title": "TelemetryInput",
        "type": "object"
      },
      "ThreatCounts": {
        "properties": {
          "high": {
            "default": 0,
            "title": "High",
            "type": "integer"
          },
          "low": {
            "default": 0,
            "title": "Low",
            "type": "integer"
          },
          "medium": {
            "default": 0,
            "title": "Medium",
            "type": "integer"
          },
          "none": {
            "default": 0,
            "title": "None",
            "type": "integer"
          }
        },
        "title": "ThreatCounts",
        "type": "object"
      },
      "TieD": {
        "properties": {
          "ao_required": {
            "default": false,
            "title": "Ao Required",
            "type": "boolean"
          },
          "classification": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Classification"
          },
          "disruption_limited": {
            "default": false,
            "title": "Disruption Limited",
            "type": "boolean"
          },
          "gating_decision": {
            "default": "allow",
            "enum": [
              "allow",
              "require_approval",
              "reject"
            ],
            "title": "Gating Decision",
            "type": "string"
          },
          "persona": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          },
          "policy_hash": {
            "pattern": "^[0-9a-f]{64}$",
            "title": "Policy Hash",
            "type": "string"
          },
          "policy_version": {
            "default": "doctrine-v1",
            "title": "Policy Version",
            "type": "string"
          },
          "roe_applied": {
            "default": false,
            "title": "Roe Applied",
            "type": "boolean"
          },
          "service_impact": {
            "default": 0.0,
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Service Impact",
            "type": "number"
          },
          "user_impact": {
            "default": 0.0,
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "User Impact",
            "type": "number"
          }
        },
        "required": [
          "policy_hash"
        ],
        "title": "TieD",
        "type": "object"
      },
      "TopItem": {
        "properties": {
          "count": {
            "title": "Count",
            "type": "integer"
          },
          "name": {
            "title": "Name",
            "type": "string"
          }
        },
        "required": [
          "name",
          "count"
        ],
        "title": "TopItem",
        "type": "object"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "title": "Location",
            "type": "array"
          },
          "msg": {
            "title": "Message",
            "type": "string"
          },
          "type": {
            "title": "Error Type",
            "type": "string"
          }
        },
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError",
        "type": "object"
      }
    }
  },
  "info": {
    "title": "frostgate-core",
    "version": "0.8.0"
  },
  "openapi": "3.1.0",
  "paths": {
    "/approvals": {
      "post": {
        "operationId": "create_approval_approvals_post",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApprovalCreateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Create Approval Approvals Post",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Approval",
        "tags": [
          "attestation"
        ]
      }
    },
    "/approvals/verify": {
      "post": {
        "operationId": "verify_approvals_approvals_verify_post",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApprovalVerifyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Verify Approvals Approvals Verify Post",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Verify Approvals",
        "tags": [
          "attestation"
        ]
      }
    },
    "/approvals/{subject_type}/{subject_id}": {
      "get": {
        "operationId": "list_approvals_approvals__subject_type___subject_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "subject_type",
            "required": true,
            "schema": {
              "title": "Subject Type",
              "type": "string"
            }
          },
          {
            "in": "path",
            "name": "subject_id",
            "required": true,
            "schema": {
              "title": "Subject Id",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "X-Tenant-Id",
            "required": true,
            "schema": {
              "title": "X-Tenant-Id",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "type": "object"
                  },
                  "title": "Response List Approvals Approvals  Subject Type   Subject Id  Get",
                  "type": "array"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "List Approvals",
        "tags": [
          "attestation"
        ]
      }
    },
    "/audit/export": {
      "get": {
        "operationId": "audit_export_audit_export_get",
        "parameters": [
          {
            "in": "query",
            "name": "start",
            "required": true,
            "schema": {
              "title": "Start",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "end",
            "required": true,
            "schema": {
              "title": "End",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "purpose",
            "required": false,
            "schema": {
              "default": "compliance-review",
              "title": "Purpose",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "retention_class",
            "required": false,
            "schema": {
              "default": "regulated",
              "title": "Retention Class",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "force",
            "required": false,
            "schema": {
              "default": false,
              "title": "Force",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Audit Export",
        "tags": [
          "audit"
        ]
      }
    },
    "/audit/export-jobs": {
      "post": {
        "operationId": "create_export_job_audit_export_jobs_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExportJobRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Export Job",
        "tags": [
          "audit"
        ]
      }
    },
    "/audit/export-jobs/{job_id}": {
      "get": {
        "operationId": "get_export_job_audit_export_jobs__job_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "job_id",
            "required": true,
            "schema": {
              "title": "Job Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Export Job",
        "tags": [
          "audit"
        ]
      }
    },
    "/audit/export-jobs/{job_id}/cancel": {
      "post": {
        "operationId": "cancel_job_audit_export_jobs__job_id__cancel_post",
        "parameters": [
          {
            "in": "path",
            "name": "job_id",
            "required": true,
            "schema": {
              "title": "Job Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CancelJobRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Cancel Job",
        "tags": [
          "audit"
        ]
      }
    },
    "/audit/export-jobs/{job_id}/run": {
      "post": {
        "operationId": "run_job_audit_export_jobs__job_id__run_post",
        "parameters": [
          {
            "in": "path",
            "name": "job_id",
            "required": true,
            "schema": {
              "title": "Job Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Run Job",
        "tags": [
          "audit"
        ]
      }
    },
    "/audit/exports": {
      "get": {
        "operationId": "audit_exports_index_audit_exports_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "retention_class",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Retention Class"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 100,
              "maximum": 500,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "default": 0,
              "minimum": 0,
              "title": "Offset",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Audit Exports Index",
        "tags": [
          "audit"
        ]
      }
    },
    "/audit/reproduce": {
      "post": {
        "operationId": "audit_reproduce_audit_reproduce_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReproduceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Audit Reproduce",
        "tags": [
          "audit"
        ]
      }
    },
    "/audit/retention/apply": {
      "post": {
        "operationId": "audit_apply_retention_audit_retention_apply_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RetentionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Audit Apply Retention",
        "tags": [
          "audit"
        ]
      }
    },
    "/audit/sessions": {
      "get": {
        "operationId": "audit_sessions_audit_sessions_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Audit Sessions",
        "tags": [
          "audit"
        ]
      }
    },
    "/config/versions": {
      "post": {
        "operationId": "write_config_version_config_versions_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfigWriteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Write Config Version Config Versions Post",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Write Config Version",
        "tags": [
          "config"
        ]
      }
    },
    "/decisions": {
      "get": {
        "operationId": "list_decisions_decisions_get",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 20,
              "maximum": 200,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "default": 0,
              "maximum": 200000,
              "minimum": 0,
              "title": "Offset",
              "type": "integer"
            }
          },
          {
            "description": "Include request/response JSON blobs (slower)",
            "in": "query",
            "name": "include_raw",
            "required": false,
            "schema": {
              "default": false,
              "description": "Include request/response JSON blobs (slower)",
              "title": "Include Raw",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "event_type",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Event Type"
            }
          },
          {
            "in": "query",
            "name": "threat_level",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Threat Level"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DecisionsPage"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "List Decisions",
        "tags": [
          "decisions"
        ]
      }
    },
    "/decisions/{decision_id}": {
      "get": {
        "operationId": "get_decision_decisions__decision_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "decision_id",
            "required": true,
            "schema": {
              "title": "Decision Id",
              "type": "integer"
            }
          },
          {
            "description": "Include request/response JSON blobs",
            "in": "query",
            "name": "include_raw",
            "required": false,
            "schema": {
              "default": true,
              "description": "Include request/response JSON blobs",
              "title": "Include Raw",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DecisionOut"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Decision",
        "tags": [
          "decisions"
        ]
      }
    },
    "/defend": {
      "post": {
        "operationId": "defend_defend_post",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TelemetryInput"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DefendResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Defend",
        "tags": [
          "defend"
        ]
      }
    },
    "/evidence/bundles": {
      "post": {
        "operationId": "create_evidence_bundle_evidence_bundles_post",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EvidenceBundleCreateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EvidenceBundleCreateResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Evidence Bundle",
        "tags": [
          "attestation"
        ]
      }
    },
    "/evidence/bundles/{bundle_id}": {
      "get": {
        "operationId": "get_evidence_bundle_evidence_bundles__bundle_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "bundle_id",
            "required": true,
            "schema": {
              "title": "Bundle Id",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Get Evidence Bundle Evidence Bundles  Bundle Id  Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Evidence Bundle",
        "tags": [
          "attestation"
        ]
      }
    },
    "/evidence/verify": {
      "post": {
        "operationId": "verify_evidence_evidence_verify_post",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EvidenceVerifyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EvidenceVerifyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Verify Evidence",
        "tags": [
          "attestation"
        ]
      }
    },
    "/feed/live": {
      "get": {
        "operationId": "feed_live_feed_live_get",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 50,
              "maximum": 200,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "since_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minimum": 0,
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Since Id"
            }
          },
          {
            "in": "query",
            "name": "severity",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Severity"
            }
          },
          {
            "in": "query",
            "name": "threat_level",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Threat Level"
            }
          },
          {
            "in": "query",
            "name": "action_taken",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Action Taken"
            }
          },
          {
            "in": "query",
            "name": "source",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Source"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "description": "search event_type/event_id/source",
            "in": "query",
            "name": "q",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "search event_type/event_id/source",
              "title": "Q"
            }
          },
          {
            "in": "query",
            "name": "only_changed",
            "required": false,
            "schema": {
              "default": false,
              "title": "Only Changed",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "only_actionable",
            "required": false,
            "schema": {
              "default": false,
              "title": "Only Actionable",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeedLiveResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Feed Live",
        "tags": [
          "feed"
        ]
      }
    },
    "/feed/stream": {
      "get": {
        "description": "Production SSE endpoint:\n  - never throws inside generator (prevents 500 'Internal Server Error')\n  - emits batches as JSON: {\"items\":[...], \"next_since_id\": N}\n  - heartbeat ': ping' comments keep proxies happy\n  - reuses feed_live() for filtering consistency",
        "operationId": "feed_stream_feed_stream_get",
        "parameters": [
          {
            "in": "query",
            "name": "interval",
            "required": false,
            "schema": {
              "default": 1.0,
              "maximum": 10.0,
              "minimum": 0.2,
              "title": "Interval",
              "type": "number"
            }
          },
          {
            "in": "query",
            "name": "heartbeat",
            "required": false,
            "schema": {
              "default": 10.0,
              "maximum": 60.0,
              "minimum": 2.0,
              "title": "Heartbeat",
              "type": "number"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 50,
              "maximum": 200,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "since_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minimum": 0,
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Since Id"
            }
          },
          {
            "in": "query",
            "name": "severity",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Severity"
            }
          },
          {
            "in": "query",
            "name": "threat_level",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Threat Level"
            }
          },
          {
            "in": "query",
            "name": "action_taken",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Action Taken"
            }
          },
          {
            "in": "query",
            "name": "source",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Source"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "description": "search event_type/event_id/source",
            "in": "query",
            "name": "q",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "search event_type/event_id/source",
              "title": "Q"
            }
          },
          {
            "in": "query",
            "name": "only_changed",
            "required": false,
            "schema": {
              "default": false,
              "title": "Only Changed",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "only_actionable",
            "required": false,
            "schema": {
              "default": false,
              "title": "Only Actionable",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Feed Stream",
        "tags": [
          "feed"
        ]
      },
      "head": {
        "operationId": "feed_stream_head_feed_stream_head",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Feed Stream Head",
        "tags": [
          "feed"
        ]
      }
    },
    "/forensics/audit_trail/{event_id}": {
      "get": {
        "operationId": "audit_trail_forensics_audit_trail__event_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "title": "Event Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Audit Trail Forensics Audit Trail  Event Id  Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Audit Trail",
        "tags": [
          "forensics"
        ]
      }
    },
    "/forensics/chain/verify": {
      "get": {
        "operationId": "chain_verify_forensics_chain_verify_get",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 10,
              "maximum": 500,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Chain Verify Forensics Chain Verify Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Chain Verify",
        "tags": [
          "forensics"
        ]
      }
    },
    "/forensics/snapshot/{event_id}": {
      "get": {
        "operationId": "snapshot_forensics_snapshot__event_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "title": "Event Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Snapshot Forensics Snapshot  Event Id  Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Snapshot",
        "tags": [
          "forensics"
        ]
      }
    },
    "/governance/changes": {
      "get": {
        "description": "List all policy change requests.\n\nSecurity: Requires authentication + governance scope (INV-005).\nPersistence: Database-backed, survives restart (P0).",
        "operationId": "list_changes_governance_changes_get",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 50,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "default": 0,
              "minimum": 0,
              "title": "Offset",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/PolicyChangeResponse"
                  },
                  "title": "Response List Changes Governance Changes Get",
                  "type": "array"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "List Changes",
        "tags": [
          "governance"
        ]
      },
      "post": {
        "description": "Create a new policy change request.\n\nSecurity: Requires authentication + governance scope (INV-005).\nPersistence: Database-backed, survives restart (P0).\nAudit: Timestamp and proposer recorded.",
        "operationId": "create_change_governance_changes_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PolicyChangeCreate"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyChangeResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Change",
        "tags": [
          "governance"
        ]
      }
    },
    "/governance/changes/{change_id}/approve": {
      "post": {
        "description": "Approve a policy change request.\n\nSecurity: Requires authentication + governance scope (INV-005).\nPersistence: Database-backed, survives restart (P0).\nAudit: Approval timestamp and approver recorded.",
        "operationId": "approve_change_governance_changes__change_id__approve_post",
        "parameters": [
          {
            "in": "path",
            "name": "change_id",
            "required": true,
            "schema": {
              "title": "Change Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PolicyApprovalRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PolicyChangeResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Approve Change",
        "tags": [
          "governance"
        ]
      }
    },
    "/health": {
      "get": {
        "operationId": "health_health_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Health Health Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health"
      }
    },
    "/health/live": {
      "get": {
        "operationId": "health_live_health_live_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Health Live Health Live Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health Live"
      }
    },
    "/health/ready": {
      "get": {
        "operationId": "health_ready_health_ready_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Health Ready Health Ready Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health Ready"
      }
    },
    "/ingest": {
      "post": {
        "description": "Ingest telemetry, evaluate, persist.\nThis endpoint should not hard-crash on evaluation/persistence errors.",
        "operationId": "ingest_ingest_post",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-Tenant-Id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Tenant-Id"
            }
          },
          {
            "in": "header",
            "name": "X-Config-Hash",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Config-Hash"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IngestRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IngestResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "detail": {
                      "properties": {
                        "error": {
                          "properties": {
                            "code": {
                              "enum": [
                                "INGEST_EVENT_ID_REQUIRED",
                                "INGEST_EVENT_ID_INVALID",
                                "CONFIG_HASH_NOT_FOUND",
                                "CONFIG_ACTIVE_MISSING"
                              ],
                              "type": "string"
                            },
                            "details": {
                              "type": "object"
                            },
                            "message": {
                              "type": "string"
                            }
                          },
                          "required": [
                            "code",
                            "message"
                          ],
                          "type": "object"
                        }
                      },
                      "required": [
                        "error"
                      ],
                      "type": "object"
                    }
                  },
                  "required": [
                    "detail"
                  ],
                  "type": "object"
                }
              }
            },
            "description": "Bad Request"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ingest",
        "tags": [
          "ingest"
        ]
      }
    },
    "/keys": {
      "get": {
        "description": "List API keys.\n\nRequires `keys:admin` scope.\nDoes not return the actual key secrets.",
        "operationId": "get_keys_keys_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "include_disabled",
            "required": false,
            "schema": {
              "default": false,
              "title": "Include Disabled",
              "type": "boolean"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListKeysResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Keys",
        "tags": [
          "keys"
        ]
      },
      "post": {
        "description": "Create a new API key.\n\nRequires `keys:admin` scope.",
        "operationId": "create_key_keys_post",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateKeyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateKeyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Key",
        "tags": [
          "keys"
        ]
      }
    },
    "/keys/revoke": {
      "post": {
        "description": "Revoke (disable) an API key by prefix.\n\nRequires `keys:admin` scope.",
        "operationId": "revoke_key_keys_revoke_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeKeyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevokeKeyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Revoke Key",
        "tags": [
          "keys"
        ]
      }
    },
    "/keys/rotate": {
      "post": {
        "description": "Rotate an API key, creating a new key with the same scopes.\n\nThis endpoint allows key rotation for security best practices:\n- Creates a new key with the same scopes as the old key\n- Optionally revokes the old key immediately\n- Links the new key to the old key for audit trail\n\nRequires the current key to be valid and active.",
        "operationId": "rotate_key_keys_rotate_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RotateKeyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RotateKeyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Rotate Key",
        "tags": [
          "keys"
        ]
      }
    },
    "/keys/{prefix}": {
      "delete": {
        "description": "Delete (revoke) an API key by prefix.\n\nRequires `keys:admin` scope.\nThis is an alias for POST /keys/revoke for REST compliance.",
        "operationId": "delete_key_keys__prefix__delete",
        "parameters": [
          {
            "in": "path",
            "name": "prefix",
            "required": true,
            "schema": {
              "title": "Prefix",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevokeKeyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Delete Key",
        "tags": [
          "keys"
        ]
      }
    },
    "/missions": {
      "get": {
        "operationId": "list_missions_missions_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/MissionEnvelope"
                  },
                  "title": "Response List Missions Missions Get",
                  "type": "array"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "List Missions",
        "tags": [
          "missions"
        ]
      }
    },
    "/missions/{mission_id}": {
      "get": {
        "operationId": "get_mission_missions__mission_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "mission_id",
            "required": true,
            "schema": {
              "title": "Mission Id",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MissionEnvelope"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Mission",
        "tags": [
          "missions"
        ]
      }
    },
    "/missions/{mission_id}/status": {
      "get": {
        "operationId": "mission_status_missions__mission_id__status_get",
        "parameters": [
          {
            "in": "path",
            "name": "mission_id",
            "required": true,
            "schema": {
              "title": "Mission Id",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "type": "string"
                  },
                  "title": "Response Mission Status Missions  Mission Id  Status Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Mission Status",
        "tags": [
          "missions"
        ]
      }
    },
    "/modules": {
      "get": {
        "operationId": "list_modules_modules_get",
        "parameters": [
          {
            "in": "query",
            "name": "module_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Module Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "type": "object"
                  },
                  "title": "Response List Modules Modules Get",
                  "type": "array"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "List Modules",
        "tags": [
          "attestation"
        ]
      }
    },
    "/modules/enforce/{module_id}": {
      "get": {
        "operationId": "enforce_module_modules_enforce__module_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "module_id",
            "required": true,
            "schema": {
              "title": "Module Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "version",
            "required": true,
            "schema": {
              "title": "Version",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "X-Tenant-Id",
            "required": true,
            "schema": {
              "title": "X-Tenant-Id",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Enforce Module Modules Enforce  Module Id  Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Enforce Module",
        "tags": [
          "attestation"
        ]
      }
    },
    "/modules/register": {
      "post": {
        "operationId": "register_module_modules_register_post",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ModuleRegistrationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Register Module Modules Register Post",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Register Module",
        "tags": [
          "attestation"
        ]
      }
    },
    "/modules/{module_id}": {
      "get": {
        "operationId": "get_module_modules__module_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "module_id",
            "required": true,
            "schema": {
              "title": "Module Id",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "type": "object"
                  },
                  "title": "Response Get Module Modules  Module Id  Get",
                  "type": "array"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Module",
        "tags": [
          "attestation"
        ]
      }
    },
    "/rings/isolation": {
      "get": {
        "operationId": "check_isolation_rings_isolation_get",
        "parameters": [
          {
            "in": "query",
            "name": "source",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/ClassificationRing"
            }
          },
          {
            "in": "query",
            "name": "target",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/ClassificationRing"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "type": "boolean"
                  },
                  "title": "Response Check Isolation Rings Isolation Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Check Isolation",
        "tags": [
          "rings"
        ]
      }
    },
    "/rings/policies": {
      "get": {
        "operationId": "list_policies_rings_policies_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RingPolicy"
                  },
                  "title": "Response List Policies Rings Policies Get",
                  "type": "array"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "List Policies",
        "tags": [
          "rings"
        ]
      }
    },
    "/rings/route": {
      "post": {
        "operationId": "route_request_rings_route_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RingRouteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RingRouteResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Route Request",
        "tags": [
          "rings"
        ]
      }
    },
    "/roe/evaluate": {
      "post": {
        "operationId": "evaluate_roe_roe_evaluate_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ROEEvaluationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ROEEvaluationResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Evaluate Roe",
        "tags": [
          "roe"
        ]
      }
    },
    "/roe/policy": {
      "get": {
        "operationId": "get_policy_roe_policy_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ROEPolicy"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Get Policy",
        "tags": [
          "roe"
        ]
      }
    },
    "/stats": {
      "get": {
        "operationId": "get_stats_stats_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatsResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Stats",
        "tags": [
          "stats"
        ]
      }
    },
    "/stats/summary": {
      "get": {
        "description": "Marketing-friendly summary payload for dashboard headers.\nBuilt from the same underlying computation to avoid drift.",
        "operationId": "get_stats_summary_stats_summary_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatsSummaryResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Stats Summary",
        "tags": [
          "stats"
        ]
      }
    },
    "/ui/audit/chain-integrity": {
      "get": {
        "operationId": "ui_audit_chain_integrity_ui_audit_chain_integrity_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "items": {
                      "type": "string"
                    },
                    "type": "array",
                    "uniqueItems": true
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Required Scopes"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Audit Chain Integrity",
        "tags": [
          "ui-audit"
        ]
      }
    },
    "/ui/audit/export-link": {
      "get": {
        "operationId": "ui_audit_export_link_ui_audit_export_link_get",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "items": {
                      "type": "string"
                    },
                    "type": "array",
                    "uniqueItems": true
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Required Scopes"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Audit Export Link",
        "tags": [
          "ui-audit"
        ]
      }
    },
    "/ui/audit/overview": {
      "get": {
        "operationId": "ui_audit_overview_ui_audit_overview_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "items": {
                      "type": "string"
                    },
                    "type": "array",
                    "uniqueItems": true
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Required Scopes"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Audit Overview",
        "tags": [
          "ui-audit"
        ]
      }
    },
    "/ui/audit/status": {
      "get": {
        "operationId": "ui_audit_status_ui_audit_status_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "sqlite_path",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sqlite Path"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "items": {
                      "type": "string"
                    },
                    "type": "array",
                    "uniqueItems": true
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Required Scopes"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Audit Status",
        "tags": [
          "ui-audit"
        ]
      }
    }
  }
}
