version: "3.9"

services:
  frostgate-core:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: frostgate-core
    environment:
      # Base app config
      FROSTGATE_ENV: "dev"
      FROSTGATE_ENFORCEMENT_MODE: "observe"
      FROSTGATE_LOG_LEVEL: "DEBUG"

      # API key / tenant for local smoke
      # This should match whatever your tools.tenants CLI emits if you want real multi-tenant auth.
      FROSTGATE_API_KEY: "dev-local-supersecret"
    ports:
      - "8080:8080"
    volumes:
      # Persist anchor / chaos state
      - ./state:/app/state
    restart: unless-stopped
