{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://frostgate/contracts/admin/config_change_event.json",
  "title": "AdminConfigChangeEvent",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "change_id",
    "tenant_id",
    "field",
    "before",
    "after",
    "scope",
    "timestamp",
    "request_id",
    "revert_supported",
    "reverted",
    "snapshot_hash"
  ],
  "properties": {
    "change_id": {"type": "string", "pattern": "^[A-Za-z0-9_-]{16,64}$"},
    "tenant_id": {"type": "string", "minLength": 1, "maxLength": 128},
    "field": {"type": "string", "enum": ["custom_quota", "tier"]},
    "before": {},
    "after": {},
    "scope": {"type": "string"},
    "timestamp": {"type": "string", "format": "date-time"},
    "request_id": {"type": ["string", "null"]},
    "revert_supported": {"type": "boolean", "const": true},
    "reverted": {"type": "boolean"},
    "reverted_at": {"type": "string", "format": "date-time"},
    "reverted_value": {},
    "revert_prev_hash": {"type": "string"},
    "revert_new_hash": {"type": "string"},
    "snapshot_hash": {"type": "string", "pattern": "^[a-f0-9]{64}$"}
  }
}
