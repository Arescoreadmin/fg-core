{
  "components": {
    "schemas": {
      "AdminCreateKeyRequest": {
        "description": "Request to create a new API key via admin.",
        "properties": {
          "name": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Human-readable name for the key",
            "title": "Name"
          },
          "scopes": {
            "description": "List of scopes to grant to the key",
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "description": "Tenant ID to associate with the key",
            "maxLength": 128,
            "title": "Tenant Id",
            "type": "string"
          },
          "ttl_seconds": {
            "default": 86400,
            "description": "Time-to-live in seconds (default 24 hours)",
            "maximum": 31536000.0,
            "minimum": 60.0,
            "title": "Ttl Seconds",
            "type": "integer"
          }
        },
        "required": [
          "tenant_id"
        ],
        "title": "AdminCreateKeyRequest",
        "type": "object"
      },
      "AdminRotateKeyRequest": {
        "description": "Request to rotate an API key via admin.",
        "properties": {
          "revoke_old": {
            "default": true,
            "description": "Whether to revoke the old key immediately",
            "title": "Revoke Old",
            "type": "boolean"
          },
          "tenant_id": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Optional tenant ID for validation",
            "title": "Tenant Id"
          },
          "ttl_seconds": {
            "default": 86400,
            "description": "TTL for the new key (default 24 hours)",
            "maximum": 31536000.0,
            "minimum": 60.0,
            "title": "Ttl Seconds",
            "type": "integer"
          }
        },
        "title": "AdminRotateKeyRequest",
        "type": "object"
      },
      "AuditEvent": {
        "description": "Audit event response.",
        "properties": {
          "action": {
            "title": "Action",
            "type": "string"
          },
          "actor": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Actor"
          },
          "id": {
            "title": "Id",
            "type": "string"
          },
          "ip": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Ip"
          },
          "meta": {
            "title": "Meta",
            "type": "object"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "resource_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Resource Id"
          },
          "resource_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Resource Type"
          },
          "status": {
            "enum": [
              "success",
              "deny",
              "error"
            ],
            "title": "Status",
            "type": "string"
          },
          "tenant_id": {
            "title": "Tenant Id",
            "type": "string"
          },
          "ts": {
            "format": "date-time",
            "title": "Ts",
            "type": "string"
          },
          "user_agent": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "User Agent"
          }
        },
        "required": [
          "id",
          "ts",
          "tenant_id",
          "action",
          "status",
          "meta"
        ],
        "title": "AuditEvent",
        "type": "object"
      },
      "AuditExportRequest": {
        "description": "Audit export request.",
        "properties": {
          "action": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Action"
          },
          "actor": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Actor"
          },
          "format": {
            "enum": [
              "csv",
              "json"
            ],
            "title": "Format",
            "type": "string"
          },
          "from_ts": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "From Ts"
          },
          "page_size": {
            "default": 1000,
            "maximum": 5000.0,
            "minimum": 1.0,
            "title": "Page Size",
            "type": "integer"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "resource_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Resource Id"
          },
          "resource_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Resource Type"
          },
          "status": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Status"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "to_ts": {
            "anyOf": [
              {
                "format": "date-time",
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "To Ts"
          }
        },
        "required": [
          "format"
        ],
        "title": "AuditExportRequest",
        "type": "object"
      },
      "AuditPacketRequest": {
        "properties": {
          "from_ts": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "From Ts"
          },
          "tenant_id": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "to_ts": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "To Ts"
          }
        },
        "title": "AuditPacketRequest",
        "type": "object"
      },
      "AuditPacketResponse": {
        "properties": {
          "created_at": {
            "title": "Created At",
            "type": "string"
          },
          "download_url": {
            "title": "Download Url",
            "type": "string"
          },
          "manifest": {
            "title": "Manifest",
            "type": "object"
          },
          "packet_id": {
            "title": "Packet Id",
            "type": "string"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "tenant_id": {
            "title": "Tenant Id",
            "type": "string"
          }
        },
        "required": [
          "tenant_id",
          "packet_id",
          "created_at",
          "download_url",
          "request_id",
          "manifest"
        ],
        "title": "AuditPacketResponse",
        "type": "object"
      },
      "AuditSearchResponse": {
        "description": "Audit search response.",
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/AuditEvent"
            },
            "title": "Items",
            "type": "array"
          },
          "next_cursor": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Next Cursor"
          }
        },
        "required": [
          "items"
        ],
        "title": "AuditSearchResponse",
        "type": "object"
      },
      "ChainVerifyResponse": {
        "properties": {
          "checked": {
            "title": "Checked",
            "type": "integer"
          },
          "first_bad": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "First Bad"
          },
          "mode": {
            "default": "linkage",
            "title": "Mode",
            "type": "string"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "status": {
            "title": "Status",
            "type": "string"
          },
          "strict_ok": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Strict Ok"
          },
          "strict_reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Strict Reason"
          },
          "tenant_id": {
            "title": "Tenant Id",
            "type": "string"
          }
        },
        "required": [
          "tenant_id",
          "status",
          "checked"
        ],
        "title": "ChainVerifyResponse",
        "type": "object"
      },
      "CircuitBreakerStatsResponse": {
        "description": "Response for circuit breaker stats.",
        "properties": {
          "failure_count": {
            "title": "Failure Count",
            "type": "integer"
          },
          "name": {
            "title": "Name",
            "type": "string"
          },
          "state": {
            "title": "State",
            "type": "string"
          },
          "success_count": {
            "title": "Success Count",
            "type": "integer"
          },
          "total_calls": {
            "title": "Total Calls",
            "type": "integer"
          },
          "total_failures": {
            "title": "Total Failures",
            "type": "integer"
          },
          "total_successes": {
            "title": "Total Successes",
            "type": "integer"
          }
        },
        "required": [
          "name",
          "state",
          "failure_count",
          "success_count",
          "total_calls",
          "total_failures",
          "total_successes"
        ],
        "title": "CircuitBreakerStatsResponse",
        "type": "object"
      },
      "ControlDetail": {
        "properties": {
          "description": {
            "title": "Description",
            "type": "string"
          },
          "evidence": {
            "items": {
              "type": "object"
            },
            "title": "Evidence",
            "type": "array"
          },
          "inv_id": {
            "title": "Inv Id",
            "type": "string"
          },
          "name": {
            "title": "Name",
            "type": "string"
          },
          "remediation": {
            "title": "Remediation",
            "type": "string"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "status": {
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "inv_id",
          "name",
          "status",
          "description",
          "evidence",
          "remediation",
          "request_id"
        ],
        "title": "ControlDetail",
        "type": "object"
      },
      "ControlSummary": {
        "properties": {
          "evidence_count": {
            "title": "Evidence Count",
            "type": "integer"
          },
          "inv_id": {
            "title": "Inv Id",
            "type": "string"
          },
          "name": {
            "title": "Name",
            "type": "string"
          },
          "remediation": {
            "title": "Remediation",
            "type": "string"
          },
          "status": {
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "inv_id",
          "name",
          "status",
          "evidence_count",
          "remediation"
        ],
        "title": "ControlSummary",
        "type": "object"
      },
      "ControlsPage": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/ControlSummary"
            },
            "title": "Items",
            "type": "array"
          },
          "limit": {
            "title": "Limit",
            "type": "integer"
          },
          "offset": {
            "title": "Offset",
            "type": "integer"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "total": {
            "title": "Total",
            "type": "integer"
          }
        },
        "required": [
          "items",
          "limit",
          "offset",
          "total",
          "request_id"
        ],
        "title": "ControlsPage",
        "type": "object"
      },
      "CreateKeyRequest": {
        "description": "Request to create a new API key.",
        "properties": {
          "name": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Human-readable name for the key",
            "title": "Name"
          },
          "scopes": {
            "description": "List of scopes to grant to the key",
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Tenant ID to associate with the key",
            "title": "Tenant Id"
          },
          "ttl_seconds": {
            "default": 86400,
            "description": "Time-to-live in seconds (default 24 hours)",
            "maximum": 31536000.0,
            "minimum": 60.0,
            "title": "Ttl Seconds",
            "type": "integer"
          }
        },
        "title": "CreateKeyRequest",
        "type": "object"
      },
      "CreateKeyResponse": {
        "description": "Response containing the newly created API key.",
        "properties": {
          "expires_at": {
            "description": "Unix timestamp when key expires",
            "title": "Expires At",
            "type": "integer"
          },
          "key": {
            "description": "The full API key (only shown once)",
            "title": "Key",
            "type": "string"
          },
          "prefix": {
            "description": "Key prefix for identification",
            "title": "Prefix",
            "type": "string"
          },
          "scopes": {
            "description": "Scopes granted to the key",
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Associated tenant ID",
            "title": "Tenant Id"
          },
          "ttl_seconds": {
            "description": "Time-to-live in seconds",
            "title": "Ttl Seconds",
            "type": "integer"
          }
        },
        "required": [
          "key",
          "prefix",
          "scopes",
          "tenant_id",
          "ttl_seconds",
          "expires_at"
        ],
        "title": "CreateKeyResponse",
        "type": "object"
      },
      "DecisionDetail": {
        "properties": {
          "ai_adversarial_score": {
            "title": "Ai Adversarial Score",
            "type": "number"
          },
          "anomaly_score": {
            "title": "Anomaly Score",
            "type": "number"
          },
          "chain_hash": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Chain Hash"
          },
          "created_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At"
          },
          "decision_diff": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Decision Diff"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "event_type": {
            "title": "Event Type",
            "type": "string"
          },
          "explain_summary": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Explain Summary"
          },
          "id": {
            "title": "Id",
            "type": "integer"
          },
          "latency_ms": {
            "default": 0,
            "title": "Latency Ms",
            "type": "integer"
          },
          "pq_fallback": {
            "title": "Pq Fallback",
            "type": "boolean"
          },
          "prev_hash": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Prev Hash"
          },
          "request": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Request"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "response": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Response"
          },
          "rules_triggered": {
            "items": {
              "type": "string"
            },
            "title": "Rules Triggered",
            "type": "array"
          },
          "source": {
            "title": "Source",
            "type": "string"
          },
          "tenant_id": {
            "title": "Tenant Id",
            "type": "string"
          },
          "threat_level": {
            "title": "Threat Level",
            "type": "string"
          }
        },
        "required": [
          "id",
          "created_at",
          "tenant_id",
          "source",
          "event_id",
          "event_type",
          "threat_level",
          "anomaly_score",
          "ai_adversarial_score",
          "pq_fallback"
        ],
        "title": "DecisionDetail",
        "type": "object"
      },
      "DecisionExplain": {
        "properties": {
          "anomaly_score": {
            "default": 0.0,
            "title": "Anomaly Score",
            "type": "number"
          },
          "ao_required": {
            "default": false,
            "title": "Ao Required",
            "type": "boolean"
          },
          "classification": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Classification"
          },
          "disruption_limited": {
            "default": false,
            "title": "Disruption Limited",
            "type": "boolean"
          },
          "llm_note": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Llm Note"
          },
          "persona": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          },
          "roe_applied": {
            "default": false,
            "title": "Roe Applied",
            "type": "boolean"
          },
          "rules_triggered": {
            "items": {
              "type": "string"
            },
            "title": "Rules Triggered",
            "type": "array"
          },
          "score": {
            "default": 0,
            "title": "Score",
            "type": "integer"
          },
          "summary": {
            "title": "Summary",
            "type": "string"
          },
          "tie_d": {
            "$ref": "#/components/schemas/TieD"
          }
        },
        "required": [
          "summary"
        ],
        "title": "DecisionExplain",
        "type": "object"
      },
      "DecisionListItem": {
        "properties": {
          "action_taken": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Action Taken"
          },
          "created_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "event_type": {
            "title": "Event Type",
            "type": "string"
          },
          "explain_summary": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Explain Summary"
          },
          "id": {
            "title": "Id",
            "type": "integer"
          },
          "latency_ms": {
            "default": 0,
            "title": "Latency Ms",
            "type": "integer"
          },
          "source": {
            "title": "Source",
            "type": "string"
          },
          "threat_level": {
            "title": "Threat Level",
            "type": "string"
          }
        },
        "required": [
          "id",
          "event_id",
          "event_type",
          "source",
          "threat_level"
        ],
        "title": "DecisionListItem",
        "type": "object"
      },
      "DecisionOut": {
        "properties": {
          "ai_adversarial_score": {
            "title": "Ai Adversarial Score",
            "type": "number"
          },
          "anomaly_score": {
            "title": "Anomaly Score",
            "type": "number"
          },
          "created_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At"
          },
          "decision_diff": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Decision Diff"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "event_type": {
            "title": "Event Type",
            "type": "string"
          },
          "explain_summary": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Explain Summary"
          },
          "id": {
            "title": "Id",
            "type": "integer"
          },
          "latency_ms": {
            "default": 0,
            "title": "Latency Ms",
            "type": "integer"
          },
          "pq_fallback": {
            "title": "Pq Fallback",
            "type": "boolean"
          },
          "request": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Request"
          },
          "response": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Response"
          },
          "rules_triggered": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Rules Triggered"
          },
          "source": {
            "title": "Source",
            "type": "string"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "threat_level": {
            "title": "Threat Level",
            "type": "string"
          }
        },
        "required": [
          "id",
          "tenant_id",
          "source",
          "event_id",
          "event_type",
          "threat_level",
          "anomaly_score",
          "ai_adversarial_score",
          "pq_fallback"
        ],
        "title": "DecisionOut",
        "type": "object"
      },
      "DefendResponse": {
        "properties": {
          "ai_adversarial_score": {
            "default": 0.0,
            "title": "Ai Adversarial Score",
            "type": "number"
          },
          "clock_drift_ms": {
            "title": "Clock Drift Ms",
            "type": "integer"
          },
          "event_id": {
            "title": "Event Id",
            "type": "string"
          },
          "explain": {
            "$ref": "#/components/schemas/DecisionExplain"
          },
          "explanation_brief": {
            "title": "Explanation Brief",
            "type": "string"
          },
          "mitigations": {
            "items": {
              "$ref": "#/components/schemas/MitigationAction"
            },
            "title": "Mitigations",
            "type": "array"
          },
          "policy": {
            "$ref": "#/components/schemas/PolicyDecision"
          },
          "policy_hash": {
            "title": "Policy Hash",
            "type": "string"
          },
          "pq_fallback": {
            "default": false,
            "title": "Pq Fallback",
            "type": "boolean"
          },
          "threat_level": {
            "enum": [
              "none",
              "low",
              "medium",
              "high",
              "critical"
            ],
            "title": "Threat Level",
            "type": "string"
          }
        },
        "required": [
          "explanation_brief",
          "threat_level",
          "explain",
          "clock_drift_ms",
          "event_id",
          "policy_hash",
          "policy"
        ],
        "title": "DefendResponse",
        "type": "object"
      },
      "FeedItem": {
        "properties": {
          "action_reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Action Reason"
          },
          "action_taken": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Action Taken"
          },
          "changed_fields": {
            "items": {
              "type": "string"
            },
            "title": "Changed Fields",
            "type": "array"
          },
          "confidence": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Confidence"
          },
          "decision_diff": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Decision Diff"
          },
          "decision_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Decision Id"
          },
          "event_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Event Id"
          },
          "event_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Event Type"
          },
          "fingerprint": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Fingerprint"
          },
          "id": {
            "title": "Id",
            "type": "integer"
          },
          "metadata": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Metadata"
          },
          "rules_triggered": {
            "items": {
              "type": "string"
            },
            "title": "Rules Triggered",
            "type": "array"
          },
          "score": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Score"
          },
          "severity": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Severity"
          },
          "source": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Source"
          },
          "summary": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Summary"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "threat_level": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Threat Level"
          },
          "timestamp": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timestamp"
          },
          "title": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Title"
          }
        },
        "required": [
          "id"
        ],
        "title": "FeedItem",
        "type": "object"
      },
      "FeedLiveResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/FeedItem"
            },
            "title": "Items",
            "type": "array"
          },
          "next_since_id": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Next Since Id"
          }
        },
        "title": "FeedLiveResponse",
        "type": "object"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "title": "Detail",
            "type": "array"
          }
        },
        "title": "HTTPValidationError",
        "type": "object"
      },
      "KeyInfo": {
        "description": "Information about an API key (without the secret).",
        "properties": {
          "created_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At"
          },
          "enabled": {
            "default": true,
            "title": "Enabled",
            "type": "boolean"
          },
          "expires_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expires At"
          },
          "last_used_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Used At"
          },
          "name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Name"
          },
          "prefix": {
            "title": "Prefix",
            "type": "string"
          },
          "scopes": {
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "use_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Use Count"
          }
        },
        "required": [
          "prefix"
        ],
        "title": "KeyInfo",
        "type": "object"
      },
      "KeyRotationResponse": {
        "description": "Response for key rotation.",
        "properties": {
          "grace_period_until": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Grace Period Until"
          },
          "message": {
            "title": "Message",
            "type": "string"
          },
          "new_key_prefix": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "New Key Prefix"
          },
          "old_key_prefix": {
            "title": "Old Key Prefix",
            "type": "string"
          },
          "success": {
            "title": "Success",
            "type": "boolean"
          }
        },
        "required": [
          "success",
          "old_key_prefix",
          "new_key_prefix",
          "grace_period_until",
          "message"
        ],
        "title": "KeyRotationResponse",
        "type": "object"
      },
      "KeyRotationStatusResponse": {
        "description": "Response for key rotation status.",
        "properties": {
          "created_at": {
            "title": "Created At",
            "type": "string"
          },
          "days_until_expiration": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Days Until Expiration"
          },
          "expires_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expires At"
          },
          "message": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Message"
          },
          "prefix": {
            "title": "Prefix",
            "type": "string"
          },
          "rotation_recommended": {
            "title": "Rotation Recommended",
            "type": "boolean"
          },
          "status": {
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "prefix",
          "status",
          "created_at",
          "expires_at",
          "days_until_expiration",
          "rotation_recommended",
          "message"
        ],
        "title": "KeyRotationStatusResponse",
        "type": "object"
      },
      "ListKeysResponse": {
        "description": "Response containing list of API keys.",
        "properties": {
          "keys": {
            "items": {
              "$ref": "#/components/schemas/KeyInfo"
            },
            "title": "Keys",
            "type": "array"
          },
          "total": {
            "title": "Total",
            "type": "integer"
          }
        },
        "required": [
          "keys",
          "total"
        ],
        "title": "ListKeysResponse",
        "type": "object"
      },
      "MitigationAction": {
        "properties": {
          "action": {
            "title": "Action",
            "type": "string"
          },
          "confidence": {
            "default": 1.0,
            "title": "Confidence",
            "type": "number"
          },
          "meta": {
            "anyOf": [
              {
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Meta"
          },
          "reason": {
            "title": "Reason",
            "type": "string"
          },
          "target": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Target"
          }
        },
        "required": [
          "action",
          "reason"
        ],
        "title": "MitigationAction",
        "type": "object"
      },
      "PolicyDecision": {
        "properties": {
          "allow": {
            "title": "Allow",
            "type": "boolean"
          },
          "reasons": {
            "items": {
              "type": "string"
            },
            "title": "Reasons",
            "type": "array"
          }
        },
        "required": [
          "allow"
        ],
        "title": "PolicyDecision",
        "type": "object"
      },
      "PostureResponse": {
        "properties": {
          "generated_at": {
            "title": "Generated At",
            "type": "string"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "tenant_id": {
            "title": "Tenant Id",
            "type": "string"
          },
          "tiles": {
            "items": {
              "$ref": "#/components/schemas/PostureTile"
            },
            "title": "Tiles",
            "type": "array"
          },
          "top_deny_reasons": {
            "items": {
              "type": "object"
            },
            "title": "Top Deny Reasons",
            "type": "array"
          },
          "trends": {
            "title": "Trends",
            "type": "object"
          }
        },
        "required": [
          "tenant_id",
          "generated_at",
          "request_id",
          "tiles",
          "trends",
          "top_deny_reasons"
        ],
        "title": "PostureResponse",
        "type": "object"
      },
      "PostureTile": {
        "properties": {
          "label": {
            "title": "Label",
            "type": "string"
          },
          "trend": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Trend"
          },
          "value": {
            "title": "Value",
            "type": "string"
          }
        },
        "required": [
          "label",
          "value"
        ],
        "title": "PostureTile",
        "type": "object"
      },
      "RevokeKeyRequest": {
        "description": "Request to revoke an API key.",
        "properties": {
          "prefix": {
            "description": "Key prefix to revoke",
            "maxLength": 64,
            "minLength": 1,
            "title": "Prefix",
            "type": "string"
          }
        },
        "required": [
          "prefix"
        ],
        "title": "RevokeKeyRequest",
        "type": "object"
      },
      "RevokeKeyResponse": {
        "description": "Response after revoking an API key.",
        "properties": {
          "message": {
            "title": "Message",
            "type": "string"
          },
          "prefix": {
            "title": "Prefix",
            "type": "string"
          },
          "revoked": {
            "title": "Revoked",
            "type": "boolean"
          }
        },
        "required": [
          "revoked",
          "prefix",
          "message"
        ],
        "title": "RevokeKeyResponse",
        "type": "object"
      },
      "RotateKeyRequest": {
        "description": "Request to rotate an API key.",
        "properties": {
          "current_key": {
            "description": "The current API key to rotate",
            "maxLength": 256,
            "minLength": 10,
            "title": "Current Key",
            "type": "string"
          },
          "revoke_old": {
            "default": true,
            "description": "Whether to immediately revoke the old key",
            "title": "Revoke Old",
            "type": "boolean"
          },
          "ttl_seconds": {
            "default": 86400,
            "description": "TTL for the new key (default 24 hours)",
            "maximum": 31536000.0,
            "minimum": 60.0,
            "title": "Ttl Seconds",
            "type": "integer"
          }
        },
        "required": [
          "current_key"
        ],
        "title": "RotateKeyRequest",
        "type": "object"
      },
      "RotateKeyResponse": {
        "description": "Response containing the rotated API key.",
        "properties": {
          "expires_at": {
            "description": "Unix timestamp when new key expires",
            "title": "Expires At",
            "type": "integer"
          },
          "new_key": {
            "description": "The new API key (only shown once)",
            "title": "New Key",
            "type": "string"
          },
          "new_prefix": {
            "description": "New key prefix for identification",
            "title": "New Prefix",
            "type": "string"
          },
          "old_key_revoked": {
            "description": "Whether the old key was revoked",
            "title": "Old Key Revoked",
            "type": "boolean"
          },
          "old_prefix": {
            "description": "Old key prefix (for reference)",
            "title": "Old Prefix",
            "type": "string"
          },
          "scopes": {
            "description": "Scopes inherited from old key",
            "items": {
              "type": "string"
            },
            "title": "Scopes",
            "type": "array"
          },
          "tenant_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "description": "Associated tenant ID",
            "title": "Tenant Id"
          }
        },
        "required": [
          "new_key",
          "new_prefix",
          "old_prefix",
          "scopes",
          "tenant_id",
          "expires_at",
          "old_key_revoked"
        ],
        "title": "RotateKeyResponse",
        "type": "object"
      },
      "StatsResponse": {
        "properties": {
          "avg_latency_ms_24h": {
            "default": 0.0,
            "title": "Avg Latency Ms 24H",
            "type": "number"
          },
          "decisions_1h": {
            "title": "Decisions 1H",
            "type": "integer"
          },
          "decisions_24h": {
            "title": "Decisions 24H",
            "type": "integer"
          },
          "decisions_7d": {
            "title": "Decisions 7D",
            "type": "integer"
          },
          "generated_at": {
            "title": "Generated At",
            "type": "string"
          },
          "high_threat_rate_1h": {
            "default": 0.0,
            "title": "High Threat Rate 1H",
            "type": "number"
          },
          "pct_high_medium_24h": {
            "default": 0.0,
            "title": "Pct High Medium 24H",
            "type": "number"
          },
          "threat_counts_24h": {
            "$ref": "#/components/schemas/ThreatCounts"
          },
          "top_event_types_24h": {
            "items": {
              "$ref": "#/components/schemas/TopItem"
            },
            "title": "Top Event Types 24H",
            "type": "array"
          },
          "top_rules_24h": {
            "items": {
              "$ref": "#/components/schemas/TopItem"
            },
            "title": "Top Rules 24H",
            "type": "array"
          },
          "top_sources_24h": {
            "items": {
              "$ref": "#/components/schemas/TopItem"
            },
            "title": "Top Sources 24H",
            "type": "array"
          },
          "unique_source_ips_24h": {
            "default": 0,
            "title": "Unique Source Ips 24H",
            "type": "integer"
          }
        },
        "required": [
          "generated_at",
          "decisions_1h",
          "decisions_24h",
          "decisions_7d",
          "threat_counts_24h"
        ],
        "title": "StatsResponse",
        "type": "object"
      },
      "StatsSummaryResponse": {
        "properties": {
          "generated_at": {
            "title": "Generated At",
            "type": "string"
          },
          "headline": {
            "title": "Headline",
            "type": "string"
          },
          "high_threat_rate": {
            "default": 0.0,
            "title": "High Threat Rate",
            "type": "number"
          },
          "most_active_rule": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Most Active Rule"
          },
          "risk_score_1h": {
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Risk Score 1H",
            "type": "integer"
          },
          "risk_score_24h": {
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Risk Score 24H",
            "type": "integer"
          },
          "top_event_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Top Event Type"
          },
          "trend_flag": {
            "pattern": "^(spike|steady|drop)$",
            "title": "Trend Flag",
            "type": "string"
          },
          "unique_ips": {
            "default": 0,
            "title": "Unique Ips",
            "type": "integer"
          }
        },
        "required": [
          "generated_at",
          "risk_score_24h",
          "risk_score_1h",
          "trend_flag",
          "headline"
        ],
        "title": "StatsSummaryResponse",
        "type": "object"
      },
      "SystemHealthResponse": {
        "description": "Response for detailed system health.",
        "properties": {
          "active_connections": {
            "title": "Active Connections",
            "type": "integer"
          },
          "alert_stats": {
            "title": "Alert Stats",
            "type": "object"
          },
          "circuit_breakers": {
            "items": {
              "$ref": "#/components/schemas/CircuitBreakerStatsResponse"
            },
            "title": "Circuit Breakers",
            "type": "array"
          },
          "shutdown_state": {
            "title": "Shutdown State",
            "type": "string"
          },
          "status": {
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "status",
          "shutdown_state",
          "active_connections",
          "circuit_breakers",
          "alert_stats"
        ],
        "title": "SystemHealthResponse",
        "type": "object"
      },
      "TelemetryInput": {
        "additionalProperties": true,
        "description": "Canonical request model for defend/ingest.\n\nCompatibility:\n  - New shape: payload={...} (tests use this)\n  - Legacy shape: event={...} (defend.py references req.event)\n  - Root fields: event_type/src_ip (defend.py references req.event_type)\n  - Doctrine: classification/persona as plain strings\n  - extra=allow for forward compatibility during MVP\n\nSecurity:\n  - Input validation for tenant_id, source, and IP addresses\n  - Length limits to prevent DoS",
        "properties": {
          "classification": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Classification"
          },
          "event": {
            "title": "Event",
            "type": "object"
          },
          "event_type": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Event Type"
          },
          "payload": {
            "title": "Payload",
            "type": "object"
          },
          "persona": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          },
          "source": {
            "maxLength": 256,
            "title": "Source",
            "type": "string"
          },
          "src_ip": {
            "anyOf": [
              {
                "maxLength": 45,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Src Ip"
          },
          "tenant_id": {
            "anyOf": [
              {
                "maxLength": 128,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant Id"
          },
          "timestamp": {
            "anyOf": [
              {
                "maxLength": 64,
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timestamp"
          }
        },
        "required": [
          "source"
        ],
        "title": "TelemetryInput",
        "type": "object"
      },
      "TenantQuotaUpdate": {
        "description": "Request to update tenant quota.",
        "properties": {
          "quota": {
            "description": "New daily quota (0 = unlimited)",
            "minimum": 0.0,
            "title": "Quota",
            "type": "integer"
          }
        },
        "required": [
          "quota"
        ],
        "title": "TenantQuotaUpdate",
        "type": "object"
      },
      "TenantTierUpdate": {
        "description": "Request to update tenant tier.",
        "properties": {
          "tier": {
            "description": "Subscription tier (free, starter, pro, enterprise, internal)",
            "title": "Tier",
            "type": "string"
          }
        },
        "required": [
          "tier"
        ],
        "title": "TenantTierUpdate",
        "type": "object"
      },
      "TenantUsageResponse": {
        "description": "Response for tenant usage endpoint.",
        "properties": {
          "bytes_processed": {
            "title": "Bytes Processed",
            "type": "integer"
          },
          "decision_count": {
            "title": "Decision Count",
            "type": "integer"
          },
          "period": {
            "title": "Period",
            "type": "string"
          },
          "quota_limit": {
            "title": "Quota Limit",
            "type": "integer"
          },
          "quota_pct_used": {
            "title": "Quota Pct Used",
            "type": "number"
          },
          "quota_remaining": {
            "title": "Quota Remaining",
            "type": "integer"
          },
          "request_count": {
            "title": "Request Count",
            "type": "integer"
          },
          "tenant_id": {
            "title": "Tenant Id",
            "type": "string"
          },
          "tier": {
            "title": "Tier",
            "type": "string"
          }
        },
        "required": [
          "tenant_id",
          "period",
          "request_count",
          "decision_count",
          "bytes_processed",
          "quota_limit",
          "quota_remaining",
          "quota_pct_used",
          "tier"
        ],
        "title": "TenantUsageResponse",
        "type": "object"
      },
      "ThreatCounts": {
        "properties": {
          "high": {
            "default": 0,
            "title": "High",
            "type": "integer"
          },
          "low": {
            "default": 0,
            "title": "Low",
            "type": "integer"
          },
          "medium": {
            "default": 0,
            "title": "Medium",
            "type": "integer"
          },
          "none": {
            "default": 0,
            "title": "None",
            "type": "integer"
          }
        },
        "title": "ThreatCounts",
        "type": "object"
      },
      "TieD": {
        "properties": {
          "ao_required": {
            "default": false,
            "title": "Ao Required",
            "type": "boolean"
          },
          "classification": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Classification"
          },
          "disruption_limited": {
            "default": false,
            "title": "Disruption Limited",
            "type": "boolean"
          },
          "gating_decision": {
            "default": "allow",
            "enum": [
              "allow",
              "require_approval",
              "reject"
            ],
            "title": "Gating Decision",
            "type": "string"
          },
          "persona": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Persona"
          },
          "policy_hash": {
            "pattern": "^[0-9a-f]{64}$",
            "title": "Policy Hash",
            "type": "string"
          },
          "policy_version": {
            "default": "doctrine-v1",
            "title": "Policy Version",
            "type": "string"
          },
          "roe_applied": {
            "default": false,
            "title": "Roe Applied",
            "type": "boolean"
          },
          "service_impact": {
            "default": 0.0,
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Service Impact",
            "type": "number"
          },
          "user_impact": {
            "default": 0.0,
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "User Impact",
            "type": "number"
          }
        },
        "required": [
          "policy_hash"
        ],
        "title": "TieD",
        "type": "object"
      },
      "TopItem": {
        "properties": {
          "count": {
            "title": "Count",
            "type": "integer"
          },
          "name": {
            "title": "Name",
            "type": "string"
          }
        },
        "required": [
          "name",
          "count"
        ],
        "title": "TopItem",
        "type": "object"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "title": "Location",
            "type": "array"
          },
          "msg": {
            "title": "Message",
            "type": "string"
          },
          "type": {
            "title": "Error Type",
            "type": "string"
          }
        },
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError",
        "type": "object"
      },
      "api__decisions__DecisionsPage": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/DecisionOut"
            },
            "title": "Items",
            "type": "array"
          },
          "limit": {
            "title": "Limit",
            "type": "integer"
          },
          "offset": {
            "title": "Offset",
            "type": "integer"
          },
          "total": {
            "title": "Total",
            "type": "integer"
          }
        },
        "required": [
          "limit",
          "offset",
          "total"
        ],
        "title": "DecisionsPage",
        "type": "object"
      },
      "api__ui_dashboards__DecisionsPage": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/DecisionListItem"
            },
            "title": "Items",
            "type": "array"
          },
          "limit": {
            "title": "Limit",
            "type": "integer"
          },
          "offset": {
            "title": "Offset",
            "type": "integer"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          },
          "total": {
            "title": "Total",
            "type": "integer"
          }
        },
        "required": [
          "items",
          "limit",
          "offset",
          "total",
          "request_id"
        ],
        "title": "DecisionsPage",
        "type": "object"
      }
    }
  },
  "info": {
    "title": "frostgate-core",
    "version": "0.8.0"
  },
  "openapi": "3.1.0",
  "paths": {
    "/_debug/routes": {
      "get": {
        "operationId": "debug_routes__debug_routes_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Debug Routes  Debug Routes Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Debug Routes"
      }
    },
    "/decisions": {
      "get": {
        "operationId": "list_decisions_decisions_get",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 20,
              "maximum": 200,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "default": 0,
              "maximum": 200000,
              "minimum": 0,
              "title": "Offset",
              "type": "integer"
            }
          },
          {
            "description": "Include request/response JSON blobs (slower)",
            "in": "query",
            "name": "include_raw",
            "required": false,
            "schema": {
              "default": false,
              "description": "Include request/response JSON blobs (slower)",
              "title": "Include Raw",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "event_type",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Event Type"
            }
          },
          {
            "in": "query",
            "name": "threat_level",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Threat Level"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/api__decisions__DecisionsPage"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "List Decisions",
        "tags": [
          "decisions"
        ]
      }
    },
    "/decisions/{decision_id}": {
      "get": {
        "operationId": "get_decision_decisions__decision_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "decision_id",
            "required": true,
            "schema": {
              "title": "Decision Id",
              "type": "integer"
            }
          },
          {
            "description": "Include request/response JSON blobs",
            "in": "query",
            "name": "include_raw",
            "required": false,
            "schema": {
              "default": true,
              "description": "Include request/response JSON blobs",
              "title": "Include Raw",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DecisionOut"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Decision",
        "tags": [
          "decisions"
        ]
      }
    },
    "/defend": {
      "post": {
        "operationId": "defend_defend_post",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TelemetryInput"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DefendResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Defend",
        "tags": [
          "defend"
        ]
      }
    },
    "/feed/live": {
      "get": {
        "operationId": "feed_live_feed_live_get",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 50,
              "maximum": 200,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "since_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minimum": 0,
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Since Id"
            }
          },
          {
            "in": "query",
            "name": "severity",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Severity"
            }
          },
          {
            "in": "query",
            "name": "threat_level",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Threat Level"
            }
          },
          {
            "in": "query",
            "name": "action_taken",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Action Taken"
            }
          },
          {
            "in": "query",
            "name": "source",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Source"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "description": "search event_type/event_id/source",
            "in": "query",
            "name": "q",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "search event_type/event_id/source",
              "title": "Q"
            }
          },
          {
            "in": "query",
            "name": "only_changed",
            "required": false,
            "schema": {
              "default": false,
              "title": "Only Changed",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "only_actionable",
            "required": false,
            "schema": {
              "default": false,
              "title": "Only Actionable",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeedLiveResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Feed Live",
        "tags": [
          "feed"
        ]
      }
    },
    "/feed/stream": {
      "get": {
        "description": "Production SSE endpoint:\n  - never throws inside generator (prevents 500 'Internal Server Error')\n  - emits batches as JSON: {\"items\":[...], \"next_since_id\": N}\n  - heartbeat ': ping' comments keep proxies happy\n  - reuses feed_live() for filtering consistency",
        "operationId": "feed_stream_feed_stream_get",
        "parameters": [
          {
            "in": "query",
            "name": "interval",
            "required": false,
            "schema": {
              "default": 1.0,
              "maximum": 10.0,
              "minimum": 0.2,
              "title": "Interval",
              "type": "number"
            }
          },
          {
            "in": "query",
            "name": "heartbeat",
            "required": false,
            "schema": {
              "default": 10.0,
              "maximum": 60.0,
              "minimum": 2.0,
              "title": "Heartbeat",
              "type": "number"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 50,
              "maximum": 200,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "since_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minimum": 0,
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Since Id"
            }
          },
          {
            "in": "query",
            "name": "severity",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Severity"
            }
          },
          {
            "in": "query",
            "name": "threat_level",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Threat Level"
            }
          },
          {
            "in": "query",
            "name": "action_taken",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Action Taken"
            }
          },
          {
            "in": "query",
            "name": "source",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Source"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "description": "search event_type/event_id/source",
            "in": "query",
            "name": "q",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "search event_type/event_id/source",
              "title": "Q"
            }
          },
          {
            "in": "query",
            "name": "only_changed",
            "required": false,
            "schema": {
              "default": false,
              "title": "Only Changed",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "only_actionable",
            "required": false,
            "schema": {
              "default": false,
              "title": "Only Actionable",
              "type": "boolean"
            }
          },
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Feed Stream",
        "tags": [
          "feed"
        ]
      },
      "head": {
        "operationId": "feed_stream_head_feed_stream_head",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Feed Stream Head",
        "tags": [
          "feed"
        ]
      }
    },
    "/health": {
      "get": {
        "operationId": "health_health_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Health Health Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health"
      }
    },
    "/health/detailed": {
      "get": {
        "description": "Detailed health check with all dependency status.\n\nRequires authentication.\nReturns comprehensive health information including:\n- Database connectivity and latency\n- Redis connectivity (if configured)\n- Disk space status\n- Service uptime",
        "operationId": "health_detailed_health_detailed_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Health Detailed Health Detailed Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health Detailed"
      }
    },
    "/health/live": {
      "get": {
        "description": "Kubernetes liveness probe - is the service running?",
        "operationId": "health_live_health_live_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Health Live Health Live Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health Live"
      }
    },
    "/health/ready": {
      "get": {
        "description": "Kubernetes readiness probe - can the service handle traffic?\n\nINV-007: Checks ALL configured dependencies, not just DB.\nReturns 503 if any critical dependency is unhealthy.",
        "operationId": "health_ready_health_ready_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Health Ready Health Ready Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Health Ready"
      }
    },
    "/keys": {
      "get": {
        "description": "List API keys.\n\nRequires `keys:admin` scope.\nDoes not return the actual key secrets.",
        "operationId": "get_keys_keys_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "include_disabled",
            "required": false,
            "schema": {
              "default": false,
              "title": "Include Disabled",
              "type": "boolean"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListKeysResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Keys",
        "tags": [
          "keys"
        ]
      },
      "post": {
        "description": "Create a new API key.\n\nRequires `keys:admin` scope.",
        "operationId": "create_key_keys_post",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateKeyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateKeyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Create Key",
        "tags": [
          "keys"
        ]
      }
    },
    "/keys/revoke": {
      "post": {
        "description": "Revoke (disable) an API key by prefix.\n\nRequires `keys:admin` scope.",
        "operationId": "revoke_key_keys_revoke_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeKeyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevokeKeyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Revoke Key",
        "tags": [
          "keys"
        ]
      }
    },
    "/keys/rotate": {
      "post": {
        "description": "Rotate an API key, creating a new key with the same scopes.\n\nThis endpoint allows key rotation for security best practices:\n- Creates a new key with the same scopes as the old key\n- Optionally revokes the old key immediately\n- Links the new key to the old key for audit trail\n\nRequires the current key to be valid and active.",
        "operationId": "rotate_key_keys_rotate_post",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RotateKeyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RotateKeyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Rotate Key",
        "tags": [
          "keys"
        ]
      }
    },
    "/keys/{prefix}": {
      "delete": {
        "description": "Delete (revoke) an API key by prefix.\n\nRequires `keys:admin` scope.\nThis is an alias for POST /keys/revoke for REST compliance.",
        "operationId": "delete_key_keys__prefix__delete",
        "parameters": [
          {
            "in": "path",
            "name": "prefix",
            "required": true,
            "schema": {
              "title": "Prefix",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RevokeKeyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Delete Key",
        "tags": [
          "keys"
        ]
      }
    },
    "/stats": {
      "get": {
        "operationId": "get_stats_stats_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatsResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Stats",
        "tags": [
          "stats"
        ]
      }
    },
    "/stats/debug": {
      "get": {
        "operationId": "stats_debug_stats_debug_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Stats Debug Stats Debug Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Stats Debug"
      }
    },
    "/stats/summary": {
      "get": {
        "description": "Marketing-friendly summary payload for dashboard headers.\nBuilt from the same underlying computation to avoid drift.",
        "operationId": "get_stats_summary_stats_summary_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatsSummaryResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Get Stats Summary",
        "tags": [
          "stats"
        ]
      }
    },
    "/status": {
      "get": {
        "operationId": "status_status_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Status Status Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Status"
      }
    },
    "/ui/audit/packet": {
      "post": {
        "operationId": "ui_audit_packet_ui_audit_packet_post",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AuditPacketRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditPacketResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Audit Packet",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/audit/packet/{packet_id}/download": {
      "get": {
        "operationId": "ui_audit_packet_download_ui_audit_packet__packet_id__download_get",
        "parameters": [
          {
            "in": "path",
            "name": "packet_id",
            "required": true,
            "schema": {
              "title": "Packet Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "token",
            "required": true,
            "schema": {
              "minLength": 8,
              "title": "Token",
              "type": "string"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Audit Packet Download",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/controls": {
      "get": {
        "operationId": "ui_controls_ui_controls_get",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 20,
              "maximum": 100,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "default": 0,
              "maximum": 1000,
              "minimum": 0,
              "title": "Offset",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ControlsPage"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Controls",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/controls/{inv_id}": {
      "get": {
        "operationId": "ui_control_detail_ui_controls__inv_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "inv_id",
            "required": true,
            "schema": {
              "title": "Inv Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ControlDetail"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Control Detail",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/csrf": {
      "get": {
        "operationId": "ui_csrf_ui_csrf_get",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "items": {
                      "type": "string"
                    },
                    "type": "array",
                    "uniqueItems": true
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Required Scopes"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Csrf",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/dash/controls": {
      "get": {
        "operationId": "ui_controls_page",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Controls Page",
        "tags": [
          "ui"
        ]
      }
    },
    "/ui/dash/forensics": {
      "get": {
        "operationId": "ui_forensics_page",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Forensics Page",
        "tags": [
          "ui"
        ]
      }
    },
    "/ui/dash/posture": {
      "get": {
        "operationId": "ui_posture_page",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Posture Page",
        "tags": [
          "ui"
        ]
      }
    },
    "/ui/decision/{decision_id}": {
      "get": {
        "operationId": "ui_decision_detail_ui_decision__decision_id__get",
        "parameters": [
          {
            "in": "path",
            "name": "decision_id",
            "required": true,
            "schema": {
              "title": "Decision Id",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DecisionDetail"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Decision Detail",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/decisions": {
      "get": {
        "operationId": "ui_decisions_ui_decisions_get",
        "parameters": [
          {
            "in": "query",
            "name": "limit",
            "required": false,
            "schema": {
              "default": 25,
              "maximum": 200,
              "minimum": 1,
              "title": "Limit",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "schema": {
              "default": 0,
              "maximum": 200000,
              "minimum": 0,
              "title": "Offset",
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "query",
            "name": "event_type",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Event Type"
            }
          },
          {
            "in": "query",
            "name": "threat_level",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Threat Level"
            }
          },
          {
            "in": "query",
            "name": "source",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "minLength": 1,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Source"
            }
          },
          {
            "in": "query",
            "name": "from_ts",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "From Ts"
            }
          },
          {
            "in": "query",
            "name": "to_ts",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "To Ts"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/api__ui_dashboards__DecisionsPage"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Decisions",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/feed": {
      "get": {
        "operationId": "ui_feed_page",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Feed",
        "tags": [
          "ui"
        ]
      }
    },
    "/ui/forensics/chain/verify": {
      "get": {
        "operationId": "ui_chain_verify_ui_forensics_chain_verify_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChainVerifyResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Chain Verify",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/posture": {
      "get": {
        "operationId": "ui_posture_ui_posture_get",
        "parameters": [
          {
            "in": "query",
            "name": "tenant_id",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "maxLength": 128,
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant Id"
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PostureResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Posture",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/scopes": {
      "get": {
        "operationId": "ui_scopes_ui_scopes_get",
        "parameters": [
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "anyOf": [
                  {
                    "items": {
                      "type": "string"
                    },
                    "type": "array",
                    "uniqueItems": true
                  },
                  {
                    "type": "null"
                  }
                ],
                "title": "Required Scopes"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Ui Scopes Ui Scopes Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Ui Scopes",
        "tags": [
          "ui-dashboards"
        ]
      }
    },
    "/ui/token": {
      "get": {
        "operationId": "ui_token_ui_token_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {}
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "Ui Token",
        "tags": [
          "ui"
        ]
      }
    },
    "/v1/defend": {
      "post": {
        "operationId": "defend_v1_defend_post",
        "parameters": [
          {
            "in": "query",
            "name": "_",
            "required": false,
            "schema": {
              "title": " "
            }
          },
          {
            "in": "header",
            "name": "X-API-Key",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TelemetryInput"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DefendResponse"
                }
              }
            },
            "description": "Successful Response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            },
            "description": "Validation Error"
          }
        },
        "summary": "Defend",
        "tags": [
          "defend"
        ]
      }
    },
    "/v1/status": {
      "get": {
        "operationId": "v1_status_v1_status_get",
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response V1 Status V1 Status Get",
                  "type": "object"
                }
              }
            },
            "description": "Successful Response"
          }
        },
        "summary": "V1 Status"
      }
    }
  }
}
